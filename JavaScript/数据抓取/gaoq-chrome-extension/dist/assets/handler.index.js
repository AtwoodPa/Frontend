var Je=Object.defineProperty;var We=(o,u,e)=>u in o?Je(o,u,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[u]=e;var j=(o,u,e)=>(We(o,typeof u!="symbol"?u+"":u,e),e);function R(o={}){return new Promise(function(u){console.log("content2Background",o),chrome.runtime.sendMessage(o,function(e){console.log("content2Background receive background ",e),u(e)})})}function G(o,u){return o._from="gaoqu extension "+u,o}function z(o,u,e=1){if(o){const s=o[u];if(s)return Math.ceil(typeof s=="number"?s*e:Number(s)*e);if(s===0)return s}return null}async function Y(o,u,e,s,t=null,a=5){let n=null;try{t?n=await o.ajax.post(u,t):n=await o.ajax.get(u),console.log("url",u);const c=n.data.hasOwnProperty(e);if(console.log("pass",c),!c)throw new Error("data\u6570\u636E\u51FA\u9519")}catch(c){a>0||o.baojing({tag:s,error:c.message,at:`portRequest ${u}`,url:window.location.href})}return n}function Ae(o){return(o+="0123456789abcdef"[Math.floor(Math.random()*16)])&&o.length===6?o:Ae(o)}function Xe(){return"#"+Ae("")}function oe(o,u="yyyy-MM-dd hh:mm"){let e={"M+":o.getMonth()+1,"d+":o.getDate(),"h+":o.getHours(),"m+":o.getMinutes(),"s+":o.getSeconds(),"q+":Math.floor((o.getMonth()+3)/3),S:o.getMilliseconds()};/(y+)/.test(u)&&(u=u.replace(RegExp.$1,(o.getFullYear()+"").substr(4-RegExp.$1.length)));for(let s in e)new RegExp("("+s+")").test(u)&&(u=u.replace(RegExp.$1,RegExp.$1.length===1?e[s]:("00"+e[s]).substr((""+e[s]).length)));return u}function _e(o){return Object.prototype.toString.call(o).slice(8,-1)}function te(o,u){let e=[];return o!=null&&_e(o)==="Object"&&Object.keys(o).forEach(s=>{const t=o[s];if(_e(t)==="Object"){e.push({span:24,html:u.mainLabel(s)});let a=te(t,u);e=[...e,...a]}else _e(t)==="Array"&&t&&t.length>0?t[0]instanceof Object?t.forEach(a=>{let n=te(a,u);e=[...e,...n]}):(console.log("objectToList"),e.push({span:24,html:""}),e.push({span:4,html:u.label(s)}),e.push({span:20,html:o[s].join(",")})):(e.push({span:4,html:u.label(s)}),e.push({span:4,html:o[s]}))}),e}function ue(o=1500,u){return new Promise((e,s)=>{let t=0;const a=setInterval(()=>{const n=u();n?(e(n),clearInterval(a)):(t+=50,t>o&&(e(n),clearInterval(a)))},50)})}function Ie(o=1500){return new Promise(u=>{setTimeout(u,o)})}function re(o){const u=Z(o);return u?u.innerText:""}function Z(o){const u=document.querySelector(o);return u||console.warn(`${o} of selector is null`),u}function ie(o,u){console.log(o[u]);let e=!1;for(let s of o[u])if(s.tags&&s.tags.length>0){e=!0;break}return e}function Be(o){let u=1;return o.indexOf("\u4EBF")>-1?(o=o.replace("\u4EBF",""),u=1e8):o.indexOf("\u5343\u4E07")>-1?(o=o.replace("\u5343\u4E07",""),u=1e7):o.indexOf("\u767E\u4E07")>-1?(o=o.replace("\u767E\u4E07",""),u=1e6):o.indexOf("\u4E07")>-1?(o=o.replace("\u4E07",""),u=1e4):o.indexOf("\u5343")>-1&&(o=o.replace("\u5343",""),u=1e3),Number(o)*u}var $=(o=>(o.page\u901A\u8FC7content\u53D1\u9001\u7ED9background="page\u901A\u8FC7content\u53D1\u9001\u7ED9background",o.page\u53D1\u9001\u7ED9content="page\u53D1\u9001\u7ED9content",o.background\u901A\u8FC7content\u53D1\u9001\u7ED9page="background\u901A\u8FC7content\u53D1\u9001\u7ED9page",o.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page="content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page",o.content\u53D1\u9001\u7ED9background="content\u53D1\u9001\u7ED9background",o.content\u53D1\u9001\u7ED9page="content\u53D1\u9001\u7ED9page",o.background\u53D1\u9001\u7ED9content="background\u53D1\u9001\u7ED9content",o))($||{}),V=(o=>(o.\u73AF\u5883\u68C0\u6D4B="\u73AF\u5883\u68C0\u6D4B",o.\u83B7\u53D6\u5F53\u524DtabId="\u83B7\u53D6\u5F53\u524DtabId",o.\u901A\u77E5\u5DF2\u8865\u4E01="\u901A\u77E5\u5DF2\u8865\u4E01",o.\u901A\u77E5\u5DF2\u63D0\u53D6="\u901A\u77E5\u5DF2\u63D0\u53D6",o.\u8BBE\u7F6E\u63D2\u4EF6\u8BA4\u8BC1\u7801="\u8BBE\u7F6E\u63D2\u4EF6\u8BA4\u8BC1\u7801",o.\u5173\u95ED\u5F53\u524D\u5E76\u8DF3\u8F6Ctab="\u5173\u95ED\u5F53\u524D\u5E76\u8DF3\u8F6Ctab",o.\u7CFB\u7EDF\u901A\u77E5="\u7CFB\u7EDF\u901A\u77E5",o.\u901A\u77E5\u5DF2\u5165\u5E93="\u901A\u77E5\u5DF2\u5165\u5E93",o.\u6E05\u7406\u7F13\u5B58="\u6E05\u7406\u7F13\u5B58",o.TTS="TTS",o.Cookie="Cookie",o.\u83B7\u53D6\u7248\u672C\u4FE1\u606F="\u83B7\u53D6\u7248\u672C\u4FE1\u606F",o))(V||{}),ke=(o=>(o[o.\u6296\u97F3=9]="\u6296\u97F3",o[o.\u5C0F\u7EA2\u4E66=8]="\u5C0F\u7EA2\u4E66",o))(ke||{}),J=(o=>(o[o.\u56DE\u586B\u57FA\u7840\u6570\u636E=1]="\u56DE\u586B\u57FA\u7840\u6570\u636E",o[o.\u83B7\u53D6\u84B2\u516C\u82F1\u7B49\u7EA7=2]="\u83B7\u53D6\u84B2\u516C\u82F1\u7B49\u7EA7",o[o.\u722C\u53D6\u661F\u56FE\u7B49\u7EA7=3]="\u722C\u53D6\u661F\u56FE\u7B49\u7EA7",o[o.\u722C\u53D6\u767E\u5E94\u7B49\u7EA7=4]="\u722C\u53D6\u767E\u5E94\u7B49\u7EA7",o[o.\u7ED1\u5B9A\u5C0F\u7EA2\u4E66\u54C1\u724C=5]="\u7ED1\u5B9A\u5C0F\u7EA2\u4E66\u54C1\u724C",o[o.\u7ED1\u5B9A\u767E\u5E94\u8D44\u6E90=91]="\u7ED1\u5B9A\u767E\u5E94\u8D44\u6E90",o[o.\u7ED1\u5B9A\u661F\u56FE\u8D44\u6E90=92]="\u7ED1\u5B9A\u661F\u56FE\u8D44\u6E90",o[o.\u4E3B\u9875\u81EA\u52A8\u5165\u5E93=101]="\u4E3B\u9875\u81EA\u52A8\u5165\u5E93",o[o.\u67E5\u8BE2\u767E\u5E94\u5B58\u5728\u8D44\u6E90=911]="\u67E5\u8BE2\u767E\u5E94\u5B58\u5728\u8D44\u6E90",o[o.\u67E5\u8BE2\u661F\u56FE\u5B58\u5728\u8D44\u6E90=921]="\u67E5\u8BE2\u661F\u56FE\u5B58\u5728\u8D44\u6E90",o[o.\u68C0\u6D4B\u662F\u5426\u767B\u5F55=922]="\u68C0\u6D4B\u662F\u5426\u767B\u5F55",o[o.\u9A8C\u8BC1\u7B80\u4ECB=923]="\u9A8C\u8BC1\u7B80\u4ECB",o))(J||{}),pe=(o=>(o[o.\u4E0D\u6293\u989D\u5916\u6570\u636E=0]="\u4E0D\u6293\u989D\u5916\u6570\u636E",o[o.\u6293\u53D6\u5168\u90E8\u6570\u636E=1]="\u6293\u53D6\u5168\u90E8\u6570\u636E",o[o.\u5C3D\u91CF\u6293\u53D6\u989D\u5916\u6570\u636E=2]="\u5C3D\u91CF\u6293\u53D6\u989D\u5916\u6570\u636E",o))(pe||{}),le=(o=>(o.\u63D2\u4EF6\u5165\u5E93="1",o.\u8D44\u6E90\u5165\u5E93="2",o.\u54C1\u724C\u5165\u5E93="3",o))(le||{}),W=(o=>(o.Empty="\u672A\u8BC6\u522B\u7684tag",o.Xhs="\u5C0F\u7EA2\u4E66",o.XhsSearch="\u5C0F\u7EA2\u4E66\u68C0\u7D22",o.XhsProduct="\u5C0F\u7EA2\u4E66\u5546\u54C1",o.Dy="\u6296\u97F3",o.Pgy="\u84B2\u516C\u82F1",o.PgySearch="\u84B2\u516C\u82F1\u68C0\u7D22",o.PgyProduct="\u84B2\u516C\u82F1\u5546\u54C1",o.Xt="\u661F\u56FE",o.ByResource="\u7CBE\u9009\u8054\u76DF-\u76F4\u64AD",o.ByProductHaohuo="\u767E\u5E94\u5546\u54C1(\u597D\u8D27)",o.ByProduct="\u767E\u5E94\u5546\u54C1",o.XtSearch="\u661F\u56FE\u641C\u7D22\u9875",o.XtLogin="\u661F\u56FE\u91CD\u5B9A\u5411\u767B\u5F55\u9875",o.BySearch="\u767E\u5E94\u641C\u7D22\u9875",o.OP="OP\u524D\u7AEF\u5F00\u53D1\u6216\u6D4B\u8BD5\u73AF\u5883",o.Popup="popup",o))(W||{});const Ke={\u661F\u56FE:"https://www.xingtu.cn/ad/creator/author/douyin/"};var se=(o=>(o[o.\u63D2\u4EF6=0]="\u63D2\u4EF6",o[o.\u6A71\u7A97\u9AD8\u4F63=1]="\u6A71\u7A97\u9AD8\u4F63",o[o.\u6C60\u518548\u5C0F\u65F6GMV\u8D851w=3]="\u6C60\u518548\u5C0F\u65F6GMV\u8D851w",o))(se||{}),ae=(o=>(o[o.\u84B2\u516C\u82F1=1]="\u84B2\u516C\u82F1",o[o.\u767E\u5E94=2]="\u767E\u5E94",o[o.\u661F\u56FE=3]="\u661F\u56FE",o[o.\u5C0F\u7EA2\u4E66=4]="\u5C0F\u7EA2\u4E66",o[o.\u6296\u97F3=5]="\u6296\u97F3",o[o.\u597D\u8D27=12]="\u597D\u8D27",o))(ae||{}),Q=(o=>(o[o.\u5C0F\u7EA2\u4E66=8]="\u5C0F\u7EA2\u4E66",o[o.\u6296\u97F3=9]="\u6296\u97F3",o))(Q||{});const Qe=[{label:"\u5EFA\u8054\u72B6\u6001:",key:"exist"},{label:"\u520A\u4F8B\u72B6\u6001:",key:"publication"},{label:"mcn:",key:"mcn"},{label:"\u76F4\u8054\u8FBE\u4EBA:",key:"directWise"},{label:"\u8FD4\u70B9\u6BD4\u4F8B(%):",key:"rebate"}];let Pe="https://wxapp.gaoq.com",Ye="https://ec.gaoq.com",ve="https://ec.gaoq.com";ve+="/cxuat";console.log("apiRoot","development",Pe,ve);const Ze={};let Fe=!1;function Te(o){if(!Fe){let u=new o(Pe,{fixedCost:!1,withCredentials:!1}),e=new o(Ye,{fixedCost:!1,withCredentials:!1}),s=new o(ve,{fixedCost:!1,withCredentials:!1});Fe={ajax:u,gaoq01:e,ifInstallCertPem(){return e.get("https://xx.gaoq.com/ifInstallCertPem",Ze)},resource:{fetch(t){return u.post("/resource/fetch",t)},bind(t){return u.post("/resource/bind",t)},existList(t){return u.post("/resource/exist/list",t)}},platformAccount:{record(t){return s.post("/platformAccount/record",t)}},resourceXt:{makeBymediaIdAndBloggerId(t){return u.post("/resourceXt/make/mediaIdAndBloggerId",t)}},resourceTag:{addLiveCategoryTag(t){return u.post("/resourceTag/add/liveCategoryTag",t)}},notesCollect:{addOrUpdate(t){return u.post("/notesCollect/addOrUpdate",t)}},fansPgy:{addOrUpdate(t){return u.post("/fansPgy/addOrUpdate",t)}},projectResource:{extensionBatchAdd(t){return u.post("/projectResource/extension/batchAdd",t)}},project:{extensionSearch(t){return u.post("/project/extension/search",t)}},brand:{fetch(t){return u.post("/brand/fetch",t)},bind(t){return u.post("/brand/bind",t)}},shop:{ifUpdate(t){return s.post("/shop/ifUpdate",t)},import(t){return s.post("/shop/import",t)}},goodsImport:{import(t){return s.post("/goodsImport/import",t)},checkExists(t){return s.post("/goodsImport/checkExists",t)}},goods:{extensionPatch(t){return s.post("/goods/extensionPatch",t)}},buyerLivePlan:{addOrUpdate(t){return u.post("/buyerLivePlan/addOrUpdate",t)}},liveCategory:{updateOrInsert(t){return s.post("/live-category/updateOrInsert",t)}},liveProduct:{updateOrInsert(t){return s.post("/live-product/updateOrInsert",t)}},liveShop:{updateOrInsert(t){return s.post("/live-shop/updateOrInsert",t)}},extension:{import(t,a){return u.post("/extension/import?token="+a,t)},auto(t){return u.post("/extension/auto",t)},pgyTag(t){return u.post("/extension/pgy/tag",t)},xtTag(t){return u.post("/extension/xt/tag",t)},byTag(t){return u.post("/extension/by/tag",t)},xtFieldTag(){return u.get("/extension/xt/fieldTag")}},baojing(t){return u.post("/baojing",t)}}}return Fe}class X{constructor(u,e){j(this,"options");j(this,"context");j(this,"isInstallCertPem",!1);j(this,"userTabId");j(this,"_signOut",()=>{chrome.storage.local.remove("user").then(()=>{this.userTabId.user=!1})});this.context=u,this.options=e}get api(){return Te(this.context.$ajax)}async _checkEnv(){let u=await this._ifInstallCertPem();return u&&(u=await this._ifEnvOk()),u}_ifEnvOk(){return Promise.resolve(!0)}async _prepareUser(){let{context:u}=this,e=u.$reactive({user:!1,tabId:""});this.userTabId=e,R({msg:$.content\u53D1\u9001\u7ED9background,aim:V.\u83B7\u53D6\u5F53\u524DtabId}).then(t=>{e.tabId=t+"",e.href="http://localhost:8088/#/signIn/extension?fromTabId="+t});let s=await chrome.storage.local.get("user");console.log("todo.user",s.user),e.user=s.user,chrome.runtime.onMessage.addListener((t,a,n)=>{console.log(this.options.tag,"onMessage",t);let{user:c,aim:i}=t;if($.background\u53D1\u9001\u7ED9content&&V.\u8BBE\u7F6E\u63D2\u4EF6\u8BA4\u8BC1\u7801==i){e.user=c;let r=[c.name];c.deptNames&&c.deptNames.length&&r.push(c.deptNames.join("/")),c.roleName&&r.push(c.roleName),u.$Modal.success({title:"\u63D2\u4EF6\u5DF2\u767B\u5F55",content:r.join("-")}),this._afterLogin()}n(this.options.tag+"echo backgorund")})}_afterLogin(){console.warn("Method _afterLogin not implemented.")}async _ifInstallCertPem(){if(this.isInstallCertPem||!this.options.needInstallCertPem)return!0;let u=!1;try{u=(await this.api.ifInstallCertPem()).install}catch(e){console.debug("ifInstallCertPem",e),this.api.baojing({tag:this.options.tag,message:JSON.stringify(e),site:window.location.href})}return u?(this.isInstallCertPem=!0,!0):(this.context.$Notice.error({title:"\u8BF7\u66F4\u65B0\u63D2\u4EF6\u548C\u5B89\u88C5\u8BC1\u4E66",desc:"\u8BF7\u5728OP \u4E0B\u8F7D\u4E2D\u5FC3 \u4E2D\u4E0B\u8F7D\u63D2\u4EF6\u548C\u8BC1\u4E66\uFF0C\u5E76\u6309\u7167\u6559\u7A0B\u5B89\u88C5"}),!1)}}const Se={".ivu-btn-primary":{backgroundColor:"#8c0776",color:"#ffffff",borderColor:"#8c0776",margin:"5px"},".ivu-btn-primary:hover":{color:"#fff",backgroundColor:"#a33991",borderColor:"#a33991"},".ivu-btn:not([disabled]):hover":{textDecoration:"none"},".ivu-btn-primary:hover, .ivu-btn-primary:active, .ivu-btn-primary.active":{color:" #fff"},".ivu-tabs-nav .ivu-tabs-tab-active":{color:"#8c0776"},".ivu-tabs-ink-bar":{height:"2px",boxSizing:"border-box",backgroundColor:"#8c0776",position:"absolute",left:"0",bottom:"1px",zIndex:"1",transition:"transform .3s ease-in-out",transformOrigin:"0 0"}},be={display:"inline-block",userSelect:"none",width:"16px",marginRight:"6px",transform:"scale(1.5)","-webkit-user-drag":"none"},et={cursor:"pointer","&:hover":{color:"#8c0776","text-decoration":"underline"}},ze={cursor:"pointer",boxShadow:"1px 1px 5px black",borderRadius:"50%",backgroundColor:"white",width:"50px",height:"50px",zIndex:"0",userDrag:"none"},Oe={display:"flex",flexDirection:"column","& .item":{display:"flex",lineHeight:"28px",flexDirection:"row","& .label":{minWidth:"100px"},"& .value":{flex:1,wordBreak:"break-all"}}},Le={padding:"5px"},tt={color:"#ed4014"},ut={color:"#19be6b"},st={color:"#2db7f5"},Me={".ivu-drawer-header":{height:"51px",display:"flex",alignItems:"center"},".ivu-drawer-body":{padding:0,display:"flex",flexDirection:"column"},".ivu-collapse":{flex:1,overflowX:"auto"}};function Ce(o){const{classes:u}=o.createStyleSheet({"@global":{...Me,".ivu-input-number":{marginRight:"3px"}},buttonContainer:Le,clearPadding:{padding:0},flexContainer:Oe,hoverPrimary:et,gaoqu:be,trigger:ze,success:ut,photoFlex:{display:"flex",alignItems:"center",gap:"3px","& .photo":{width:"30px"}},marginTop:{marginTop:"20%"},info:{...st,marginLeft:"10px"},error:tt,img:{width:"120px"}}).attach();return{classes:u}}const at="//cdn.red.gaoq.com";function ee(o){return o?(o=o.replace("dingUsed/","").replace("ding/",""),o.match(/^http|data:image|\/\//)?o:`${at}/resource/${o}`):null}const ot={0:"\u5F85\u5BA1\u6838",1:"\u63A8\u5E7F\u4E2D",2:"\u7533\u8BF7\u672A\u901A\u8FC7",3:"\u5408\u4F5C\u5DF2\u7EC8\u6B62",6:"\u5408\u4F5C\u5DF2\u5230\u671F"},nt={1:"\u7EC8\u6B62\u63A8\u5E7F",2:"\u5F00\u542F\u63A8\u5E7F",3:"\u5546\u5BB6\u5173\u95ED",4:"\u5546\u54C1\u4E0B\u67B6",6:"\u5E73\u53F0\u6CBB\u7406\u5173\u95ED",99:"\u5546\u5BB6\u5220\u9664",[-1e3]:"\u672A\u67E5\u5230\u5546\u54C1"};function rt(o){let u,e;if(o&&o.promotion_status){let{promotion_status:s}=o;u=nt[s]}if(o&&o.status){let{status:s}=o;e=ot[s]}return u||e?`${u||"_"}/${e||"_"}`:""}const it={0:"\u5F85\u8BA4\u9886",1:"\u5F85\u8C08\u5224",2:"\u5F85\u5BA1\u6838",3:"\u5DF2\u901A\u8FC7",4:"\u672A\u901A\u8FC7"};function we(o){return it[o]}function K(o){return typeof o=="string"&&(o=o.replace("-","")),o?(o=o.replace(/[+,%]/,""),o.indexOf("\u5343")>-1||o.indexOf("K")>-1||o.indexOf("k")>-1?(o=o.replace("\u5343","")||o.replace("K",""),Math.round(parseFloat(o)*1e3)):o.indexOf("\u4E07")>-1||o.indexOf("W")>-1||o.indexOf("w")>-1?(o=o.replace("\u4E07","")||o.replace("W",""),Math.round(parseFloat(o)*1e4)):o.indexOf("\u4EBF")>-1?(o=o.replace("\u4EBF",""),Math.round(parseFloat(o)*1e8)):parseInt(o)):null}class $e extends X{constructor(e,s){s.needInstallCertPem=!0;super(e,s);j(this,"reactive");j(this,"classes");j(this,"copyRender",e=>{let{$h:s,$Copy:t}=this.context;return s("span",{class:this.classes.hoverPrimary,onClick(){t({text:e,successTip:"\u5DF2\u590D\u5236:"+e})}},e)});j(this,"checkExists",async(e,s,t=!1)=>{let{user:a}=this.userTabId;if(a){let n={opId:a.id,token:a.token,platform:Q.\u6296\u97F3,shop_id:e,product_id:s};if(t){let{shop_name:r,shop_image:l,shop_exper_score:d,month_sale:p,corp_daren_count:m,corp_captain_count:h,views:g,avt_commission_rate:f,avg_service_rate:E}=this.reactive.shop;n.shop={shop_name:r,shop_image:l,shop_exper_score:d,month_sale:p,corp_daren_count:m,corp_captain_count:h,views:g,avt_commission_rate:f,avg_service_rate:E}}let{code:c,data:i}=await this.api.goodsImport.checkExists(n);if(c==0){let{memberList:r,...l}=i,d={};r.forEach(p=>{d[p.id]=p}),Object.assign(this.reactive,{...l,memberMap:d}),this.reactive.checked=!0}return i}});this._init()}async _init(){this._css(),await this._prepareUser(),this._view(),this._parse()}_css(){let{$jss:e}=this.context,{classes:s}=Ce(e);this.classes=s}_view(){let{context:e,_signOut:s,userTabId:t,classes:a,api:n,options:c,checkExists:i,copyRender:r}=this,{$h:l,$reactive:d,$resolveComponent:p,$toRaw:m,$Message:h,$Notice:g}=e,f=d({show:!0,loading:!1,shopList:[],goodsList:[],goodsImportList:[],memberMap:{},checked:!1,shop:{shop_id:null,shop_name:"",shop_image:"",shop_exper_score:null},goods:{aim_commission_rate:null,commission_rate:"",service_rate:"",price:null,title:"",product_id:"",cover:"",images:[],details:[],detail_url:"",from_url:"",product_highlights:"",urgent:0}});this.reactive=f,e.renderFunctionMap.door=function(){return f.show?null:l("img",{src:e.src,class:a.trigger,onClick(){f.show=!0}})},e.renderFunctionMap.drawer=function(){const E=p("Drawer"),b=p("Icon"),_=p("Collapse"),v=p("Panel"),D=p("Image"),F=p("Button"),C=p("Table"),I=p("Spin"),M=p("InputNumber"),O=p("Checkbox"),N=p("Result");let{shopList:S,goodsImportList:k,shop:y,checked:U,goods:x,goodsList:T,memberMap:H}=f,L=S.length;return l(E,{width:500,mask:!1,modelValue:f.show,"onUpdate:modelValue"(A){f.show=A}},{header(){let A=[l("img",{src:e.src,class:a.gaoqu})];return t.user?(A.push(t.user.name+"("+t.user.id+")"),A.push(l("span",{onClick:s},[l(b,{type:"md-exit",size:13}),"\u767B\u51FA"]))):t.tabId&&A.push(l("a",{href:t.href,target:"_blank"},[l(b,{type:"md-contact",size:13}),"\u767B\u5F55"])),A},default(){if(t.user){let A=[l(_,{modelValue:["shop","goods","goodsImport"]},[l(v,{name:"goodsImport"},{content(){let P=[l("div",{class:"item"},[l("span",{class:"label"},"\u8C08\u5224\u4F63\u91D1\u7387*"),l("span",{class:"value"},[l(M,{max:100,min:0,size:"small",modelValue:x.aim_commission_rate,"onUpdate:modelValue":w=>{x.aim_commission_rate=+w}}),"%",x.aim_commission_rate?"":l("span",{class:a.error},"\u8C08\u5224\u4F63\u91D1\u7387\u5FC5\u586B"+(x.commission_rate?`,\u4E0D\u80FD\u5C0F\u4E8E${x.commission_rate}%`:""))])]),l("div",{class:"item"},[l("span",{class:"label"},"\u662F\u5426\u52A0\u6025"),l(O,{trueValue:1,falseValue:0,class:"value",size:"small",modelValue:x.urgent,"onUpdate:modelValue":w=>{x.urgent=w}},"\u52A0\u6025")]),l("div",{class:"item"},[l("span",{class:"label"},"ID"),r(x.product_id)]),l("div",{class:"item"},[l("span",{class:"label"},"\u540D\u79F0"),l("span",{class:"value"},{default(){return x.title}})]),l("div",{class:"item"},[l("span",{class:"label"},"\u5C01\u9762"),x.cover?l(D,{src:x.cover,fit:"contain",preview:!0,previewList:x.details,class:a.img}):""]),l("div",{class:"item"},[l("span",{class:"label"},"\u94FE\u63A5"),l("span",{class:"value"},{default(){return x.detail_url}})]),l("div",{class:"item"},[l("span",{class:"label"},"\u6765\u6E90"),l("span",{class:"value"},{default(){return x.from_url}})])];return c.tag==W.ByProduct&&(P.unshift(l("div",{class:"item"},[l("span",{class:"label"},"\u4EF7\u683C/\u4F63\u91D1\u7387"),l("span",{class:"value"},{default(){return x.price/100+"\uFFE5/"+x.commission_rate+"%"}})])),P.push(l("div",{class:"item"},[l("span",{class:"label"},"\u4E8C\u7EA7\u56E2\u957F\u8D39\u7387"),l("span",{class:"value"},{default(){return x.service_rate+"%"}})]),l("div",{class:"item"},[l("span",{class:"label"},"\u4ECB\u7ECD"),l("span",{class:"value"},{default(){return x.product_highlights}})]))),k.length>0&&P.unshift(l(C,{data:k,size:"small",columns:[{type:"index",width:30},{title:"\u5546\u54C1",minWidth:130,className:a.clearPadding,render(w,{row:B}){return[r(B.product_id),"/",B.title]}},{title:"\u8C08\u5224\u4F63\u91D1\u7387",width:70,align:"center",fixed:"right",render(w,{row:B}){return[(B.commission_rate||0)+"%","/",w("span",{class:a.success},B.aim_commission_rate+"%")]}},{title:"\u8C08\u5224\u72B6\u6001",className:a.clearPadding,width:120,align:"center",render(w,{row:B}){return we(B.status)}},{title:"\u8C08\u5224\u4EBA\u5458",className:a.clearPadding,width:100,align:"center",render(w,{row:B}){let q=H[B.zsOpId];return q?w("div",{class:a.photoFlex},[w("img",{src:ee(q.photo),class:"photo"}),q.name]):""}},{title:"\u5165\u5E93\u65F6\u95F4",className:a.clearPadding,width:120,align:"center",render(w,{row:B}){return oe(new Date(B.createdAt))}}]})),l("div",{class:a.flexContainer},P)},default(){return["\u8C08\u5224\u5546\u54C1",l("span",{class:k.length>0?a.info:a.success},k.length>0?`\u5DF2\u5B58\u5728${k.length}\u4E2A\u76F8\u540C\u8C08\u5224\u5546\u54C1`:"")]}}),l(v,{name:"goods"},{content(){return l(C,{data:T,size:"small",columns:[{type:"index",width:30},{title:"\u5E97\u94FA",className:a.clearPadding,minWidth:110,render(P,{row:w}){return[r(w.shop_id),"/",w.shop_name]}},{title:"\u6D3B\u52A8",className:a.clearPadding,minWidth:110,render(P,{row:w}){return[w.activity_id,"/",w.activity_name]}},{title:"\u63A8\u5E7F/\u5546\u54C1\u72B6\u6001",className:a.clearPadding,width:90,render(P,{row:w}){return rt(w)}},{title:"\u63A8\u5E7F\u65F6\u95F4",align:"center",className:a.clearPadding,width:80,render(P,{row:w}){return[w.promotion_start_time,P("div",w.promotion_end_time)]}},{title:"\u4F63\u91D1\u7387",align:"center",width:60,fixed:"right",render(P,{row:w}){return[w.price/100+"\uFFE5",P("div",w.activity_cos_ratio/100+"%")]}}]})},default(){return"\u7CBE\u9009\u5546\u54C1"}}),l(v,{name:"shop"},{content(){let P=[l("div",{class:"item"},[l("span",{class:"label"},"ID"),r(y.shop_id)]),l("div",{class:"item"},[l("span",{class:"label"},"\u540D\u79F0"),l("span",{class:"value"},{default(){return y.shop_name}})]),l("div",{class:"item"},[l("span",{class:"label"},"Logo"),y.shop_image?l(D,{src:y.shop_image,fit:"contain",preview:!0,class:a.img}):""])];return U&&L>0&&P.unshift(l(C,{data:S,size:"small",columns:[{type:"index",width:30},{title:"\u5E97\u94FA",className:a.clearPadding,minWidth:130,render(w,{row:B}){return[r(B.shop_id),"/",B.shop_name]}},{title:"\u8D23\u4EFB\u5546\u52A1",width:100,className:a.clearPadding,align:"center",render(w,{row:B}){let q=H[B.zsOpId];return q?l("div",{class:a.photoFlex},[l("img",{src:ee(q.photo),class:"photo"}),q.name]):""}},{title:"\u5165\u5E93\u65F6\u95F4",width:120,className:a.clearPadding,align:"center",render(w,{row:B}){return oe(new Date(B.createdAt))}}]})),l("div",{class:a.flexContainer},P)},default(){return["\u5E97\u94FA",l("span",{class:L>0?a.info:a.success},L>0?`\u5DF2\u5B58\u5728${L}\u4E2A\u76F8\u540C\u5E97\u94FA`:"\u53EF\u5165\u5E93")]}})]),l("div",{class:a.buttonContainer},l(F,{disabled:!U,long:!0,loading:f.loading,type:"primary",async onClick(){if(x.aim_commission_rate)if(x.commission_rate&&x.aim_commission_rate<parseInt(x.commission_rate))g.error({desc:"\u8C08\u5224\u4F63\u91D1\u7387\u4E0D\u80FD\u4F4E\u4E8E"+x.commission_rate+"%"});else{f.loading=!0;let P={opId:t.user.id,token:t.user.token,shop:m(f.shop),goods:m(x)},{code:w,data:B}=await n.goodsImport.import(P);w==0&&(B>0?g.error({title:"\u65E0\u9700\u521B\u5EFA\u8C08\u5224\u5546\u54C1",desc:"\u5DF2\u5B58\u5728\u76F8\u540C\u7684\u4F63\u91D1\u7387"}):h.success("\u6210\u529F\u521B\u5EFA\u5546\u54C1\u8C08\u5224")),f.loading=!1,i(y.shop_id,x.product_id)}else g.error({desc:"\u8BF7\u5148\u586B\u5199\u8C08\u5224\u4F63\u91D1\u7387"})}},(L<1?"\u5165\u5E93":"\u66F4\u65B0")+"\u5E97\u94FA\u5E76\u521B\u5EFA\u5546\u54C1\u8C08\u5224"+(x.aim_commission_rate?x.aim_commission_rate+"%":"")))];return U||A.push(l(I,{fix:!0})),A}else return l(N,{type:"warning",title:"\u8BF7\u5148\u767B\u5F55",class:a.marginTop},{actions(){return l(F,{type:"success",onClick(){window.open(t.href,"_blank")}},"\u9A6C\u4E0A\u767B\u5F55")}})}})}}_afterLogin(){let{checked:e,shop:s,goods:t}=this.reactive;if(!e){let{shop_id:a}=s,{product_id:n}=t;a&&n&&this.checkExists(a,n,!0)}}}class lt extends $e{async _parse(){let{context:u}=this,{$bus:e}=u,s=await e.subscribe(/get_captain_goods_detail/,M=>e.parseBody(M).data),{pc_product_detail:t,commission_rate:a,month_sale:n,corp_daren_count:c,corp_captain_count:i,views:r,service_rate:l,avt_commission_rate:d,avg_service_rate:p}=s,{shop_id:m,shop_name:h,shop_image:g,shop_exper_score:f,title:E,product_id:b,cover:_,images:v,big_imgs:D,detail_url:F,product_highlights:C,price:I}=t;return m=m+"",Object.assign(this.reactive.shop,{platform:Q.\u6296\u97F3,importOrigin:se.\u63D2\u4EF6,platformOrigin:ae.\u767E\u5E94,shop_id:m,shop_name:h,shop_image:g,shop_exper_score:f,month_sale:n,corp_daren_count:c,corp_captain_count:i,views:r,avt_commission_rate:d,avg_service_rate:p}),Object.assign(this.reactive.goods,{platform:Q.\u6296\u97F3,importOrigin:se.\u63D2\u4EF6,platformOrigin:ae.\u767E\u5E94,commission_rate:a,service_rate:l,title:E,product_id:b,cover:_,images:v,details:D,detail_url:F,product_highlights:C,price:I,from_url:window.location.href}),this.checkExists(m,b,!0)}}function ct(o,u){return J.\u56DE\u586B\u57FA\u7840\u6570\u636E==u.forGaoqu?new dt(o,u):new pt(o,u)}const fe={async parse(o){var b;let{$bus:u}=o,e="",s=window.location.href,t=window.location.search.match(/id=(\d*)&?/);t&&(e=t[1]);let a=await u.subscribe(/shop\/promotion\/pack\/h5/,_=>u.parseBody(_)),{promotion_h5:n,fallback_page:c}=a;if(c&&c.show)return{product_id:e,error:c.text||"\u5546\u54C1\u4E0D\u5B58\u5728"};let{basic_info_data:i,shop_info:r,comment_data:l,product_support_info_data:d}=n,{shop_name:p,shop_logo:m,shop_id:h}=r.basic_info,{title_info:g}=i,{title:f}=g,{shop_extra_comment:E}=l;if(E){let{title_bar:_}=E;_.link&&(t=_.link.match(/shop_id=(\d*)&?/),t&&(h=t[1]))}if(console.log("shop_id",h),!h&&d){let _=(b=d.safety_content)==null?void 0:b.safety_popup_content;_&&_.forEach(v=>{let D=v.url;if(D){let F=D.split("&").find(C=>C.indexOf("url=")==0);if(F&&(D=decodeURIComponent(F.replace("url=","")),console.log("shop_id",D),D&&(F=D.split("&").find(C=>C.indexOf("biz_params=")==0),F&&(D=decodeURIComponent(F.replace("biz_params=","")),console.log("shop_id",D),D))))try{h=JSON.parse(D).shop_id,console.log("shop_id",h)}catch(C){console.error(C)}}})}return{shop_id:`${h}`,shop_name:p,shop_logo:m,title:f,product_id:e,detail_url:s}},async parseDom(){await Ie(2e3);let o=[];document.querySelectorAll(".head-figure__media-view__content").forEach(s=>{let t=s.style.backgroundImage.match(/url\("(.*)"\)/);t&&o.push(t[1])});let u=[];document.querySelectorAll(".product-big-img-list__every-img").forEach(s=>{console.log("dom.src",s.src),u.push(s.src)});let e=o[0];return{images:o,details:u,cover:e}}};class dt extends X{constructor(u,e){super(u,e),this.doSomething()}async doSomething(){let{context:u,api:e}=this,{$resolveComponent:s,$h:t}=u;u.renderFunctionMap.spin=function(){let p=s("Spin"),m=s("Modal");return t(m,{modelValue:!0,width:360,footerHide:!0,title:"\u5546\u54C1\u4FE1\u606F"},{default(){return t(p,{fix:!0},"\u63D0\u53D6\u4E2D...")}})};let{error:a,shop_id:n,shop_name:c,shop_logo:i,title:r,product_id:l,detail_url:d}=await fe.parse(this.context);if(a){let{fromTabId:p,tag:m}=this.options;R(G({id:l,toTabId:p,error:a,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u8865\u4E01,closeTab:!0},m))}else{let{images:p,details:m,cover:h}=await fe.parseDom(),{code:g,data:f}=await e.goods.extensionPatch({product_id:l,shop_logo:i,images:p,details:m});if(g==0){let{fromTabId:E,tag:b}=this.options;R(G({id:l,toTabId:E,modifiedCount:f==null?void 0:f.modifiedCount,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u8865\u4E01,closeTab:!0},b))}}}}class pt extends $e{async _parse(){let{shop_id:u,shop_name:e,shop_logo:s,title:t,product_id:a,detail_url:n}=await fe.parse(this.context);return this._parseDom(),Object.assign(this.reactive.shop,{platform:Q.\u6296\u97F3,importOrigin:se.\u63D2\u4EF6,platformOrigin:ae.\u597D\u8D27,shop_id:u,shop_name:e,shop_image:s}),Object.assign(this.reactive.goods,{platform:Q.\u6296\u97F3,importOrigin:se.\u63D2\u4EF6,platformOrigin:ae.\u597D\u8D27,title:t,product_id:a,detail_url:n,from_url:window.location.href}),this.checkExists(u,a)}async _parseDom(){let u=await fe.parseDom();Object.assign(this.reactive.goods,u)}}function ht(o,u,e){const{classes:s}=o.createStyleSheet({"@global":{otherCss:u,".ivu-card-body":{padding:"0"},".ivu-tabs":{flex:"1",display:"flex",flexDirection:"column"},".ivu-tabs-bar":{flexShrink:"0"},".ivu-table":{display:"flex",flexDirection:"column"},".ivu-table-header":{flexShrink:"0"},".ivu-tabs-content":{overflow:"hidden",flex:"1"},".ivu-table-body":{overflowY:"scroll",overflowX:"hidden"},".ivu-tabs-tabpane,.ivu-table-wrapper":{height:"100%"},".ivu-drawer-body":{display:"flex",flexDirection:"column"},".author-header":{position:"relative",width:"560px!important"},".author-info-list":{width:"560px!important"},"#crx-app":{width:"520px"},...Se},opts:{gap:"5px",display:"flex",marginRight:"5px",alignItems:"center"},opLabel:{width:"120px",display:"flex",alignItems:"center"},opItem:{margin:"0px 5px",width:"230px",display:"flex","justify-content":"space-between"},search:{display:"flex",marginRight:"70px",minHeight:"34px",position:"relative"},opWrapper:{flexShrink:"0",display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"var(--padding)"},cardOperation:{marginTop:"5px",display:"flex",justifyContent:"space-around"},insertHeaderDom:{position:"absolute",width:"300px",height:"100%",top:"0px",right:"0px",display:"flex",justifyContent:"space-between",marginRight:"10px",alignItems:"center",padding:"0px 10px"},insertDom:{position:"absolute",width:"300px",top:"0px",right:"0px",display:"flex",justifyContent:"space-between",marginRight:"10px",alignItems:"center",borderBottom:"1px solid rgb(231 225 225)",color:"#333",fontSize:"12px",lineHeight:"21px",padding:"0px 10px",borderRadius:"10px",height:"100%",boxSizing:"border-box"},"import-detail":{margin:"10px 5px",display:"inline-block",fontSize:"medium",fontWeight:"700"},"import-project-title":{margin:"0px 5px"},"import-project-resource-detail":{backgroundColor:"#b2f6b2",display:"inline-block",margin:"5px",height:"24px",lineHeight:"24px",borderRadius:"5px",fontSize:"12px",padding:"0px 5px"},"import-project-extension-detail":{backgroundColor:"rgb(181 216 236)",display:"inline-block",margin:"5px",height:"24px",lineHeight:"24px",borderRadius:"5px",fontSize:"12px",padding:"0px 5px"},opInsertItem:{margin:"0px 5px",width:"180px",display:"flex","justify-content":"space-between"},"op-done":{backgroundColor:"#b2f6b2"},"op-doing":{backgroundColor:"rgb(181 216 236)"},gaoqu:be}).attach();return{classes:s,render:{image(a,n){return e(a,{src:n,fit:"contain",preview:!0,previewList:[n],initialIndex:0,width:"80px",height:"80px"},{error(){return"\u65E0"}})},info(a){const n=[];return Qe.forEach(c=>{const{label:i,key:r}=c;a[r]&&n.push(e("div",{class:s.opInsertItem},[e("div",null,i),e("div",null,a[r])]))}),n},checkbox(a,n,c){return e(a,{modelValue:n.checked,onChange:i=>{console.log("onChange",i),n.checked=!n.checked,c(n.checked)}})}}}}function je(o,u){return o&&o.roleName?u.includes(o.roleName):!1}function De(o){return je(o,["\u7ECF\u7EAA\u4EBA","\u7ECF\u7EAA\u4E3B\u7BA1"])}function mt(o){return je(o,["\u5546\u52A1\u4E3B\u7BA1"])}class ye extends X{constructor(e,s){super(e,s);j(this,"reactive");j(this,"classes");j(this,"render");this._init()}async _init(){this._css(),await this._prepareUser(),this._view(),this.userTabId.user?this._updatePage():this.context.$Notice.error({title:"\u8BF7\u5148\u767B\u5F55\u63D2\u4EF6",desc:"\u767B\u5F55\u63D2\u4EF6\u540E\u624D\u80FD\u6B63\u5E38\u4F7F\u7528"}),this._collectTag()}_css(){let{$jss:e,$h:s}=this.context;const t=this._otherCss();let{classes:a,render:n}=ht(e,t,s);this.classes=a,this.render=n}_cardMeta(){let e=this,{$resolveComponent:s,$Message:t}=this.context;return{columns:[{type:"index",align:"center",width:30},{title:"ID",width:100,align:"center",key:"id"},{title:"\u9879\u76EE",key:"name"},{title:"\u79FB\u9664",width:100,align:"center",render(c,{row:i}){return c(s("Button"),{size:"small",shape:"circle",type:"primary",icon:"md-remove",onClick(){for(let r=0,l=e.reactive.data.length;r<l;r++)if(e.reactive.data[r].id==i.id){e.reactive.data.splice(r,1);break}e.reactive.records=[],e.reactive.storeRecords=[],console.log("this",e)}})}},{type:"selection",width:60,align:"center"}],addColumns:[{type:"index",align:"center",width:30},{title:"ID",width:100,align:"center",key:"id"},{title:"\u9879\u76EE",key:"name"},{title:"\u64CD\u4F5C",width:100,align:"center",render(c,{row:i}){return c(s("Button"),{size:"small",shape:"circle",type:"primary",icon:"md-add",onClick(){const{data:r,storeData:l,type:d}=e.reactive,p=d=="\u9879\u76EE"?r:l;p.length==0?(p.push(i),t.success({content:"\u6DFB\u52A0\u6210\u529F / "+i.id})):p.find(h=>h.id==i.id)?t.warning({content:"\u65E0\u9700\u91CD\u590D\u6DFB\u52A0"}):(p.push(i),t.success({content:"\u6DFB\u52A0\u6210\u529F / "+i.id}))}})}}]}}_afterLogin(){this._updatePage()}async _view(){const{columns:e,addColumns:s}=this._cardMeta();let t=this,{context:a,_signOut:n,classes:c,userTabId:i,render:r}=this,{$resolveComponent:l,$h:d,$Message:p,$Teleport:m}=a,h=a.$reactive({submitting:!1,resourceList:[],insertHeader:null,data:[],title:"",show:!1,type:"\u9879\u76EE",storeData:[],loading:!1,condition:{id:null,name:"",page:{size:50,total:0,current:1}},projectList:[],storeProjectList:[],columns:e,addColumns:s,records:[],storeRecords:[],importDetail:null,importDetailShow:!1});this.reactive=h,this.context.renderFunctionMap.card=function(){const g=l("Collapse"),f=l("Table"),E=l("Tabs"),b=l("TabPane"),_=l("Panel"),v=l("Button"),D=l("Card"),F=l("Icon");return d(D,{},{title(){let C=[d("img",{src:a.src,class:c.gaoqu})];return i.user&&C.push(i.user.name+"("+i.user.id+")"),C},extra(){if(i.user)return d("div",{onClick:n},[d(F,{type:"md-exit",size:13}),"\u767B\u51FA"]);if(i.tabId)return d("a",{href:i.href,target:"_blank"},[d(F,{type:"md-contact",size:13}),"\u767B\u5F55"])},default(){return d(g,{modelValue:"1"},()=>d(_,{name:"1"},{default(){return"\u6298\u53E0&\u5C55\u5F00"},content(){return[d(E,{animated:!1,modelValue:h.type,"onUpdate:modelValue":C=>h.type=C},()=>[d(b,{label:"\u9879\u76EE",name:"\u9879\u76EE"},()=>d(f,{size:"small",columns:e,data:h.data,onOnSelect(C){t._doSelect(C)},onOnSelectCancel(C){t._doUnSelect(C)},onOnSelectAll(C){t._doSelectAll(C)},onOnSelectAllCancel(C){t._doUnSelectAll(C)}})),d(b,{label:"\u50A8\u5907\u9879\u76EE",name:"\u50A8\u5907\u9879\u76EE"},()=>d(f,{size:"small",onOnSelect(C){t._doSelect(C)},onOnSelectCancel(C){t._doUnSelect(C)},onOnSelectAll(C){t._doSelectAll(C)},onOnSelectAllCancel(C){t._doUnSelectAll(C)},columns:e,data:t.reactive.storeData}))]),d("div",{class:c.cardOperation},[d(v,{type:"primary",shape:"circle",onClick(){h.show=!0}},()=>"\u6DFB\u52A0\u9879\u76EE"),d(v,{type:"primary",shape:"circle",onClick(){t._pushResource()}},()=>"\u5BFC\u5165"+h.type),d(v,{type:"primary",shape:"circle",onClick(){t._batchImport()}},()=>"\u6279\u91CF\u5165\u5E93")])]}}))}})},this.context.renderFunctionMap.draw=function(){const g=l("Table"),f=l("Button"),E=l("Drawer"),b=l("InputNumber"),_=l("Input"),v=l("Tabs"),D=l("TabPane");return d(E,{title:"\u6DFB\u52A0"+h.type,placement:"left",width:"650px",closable:!0,modelValue:t.reactive.show,"onUpdate:modelValue":F=>t.reactive.show=F},()=>[d("div",{class:c.opWrapper},[d("div",{class:c.search},[d("div",{class:c.opItem},[d("div",{class:c.opLabel},"\u9879\u76EEID"),d(b,{clearable:!0,min:0,onOnEnter(){t._searchProject()},modelValue:h.condition.id,"onUpdate:modelValue":F=>h.condition.id=F,style:"width: 240px"})]),d("div",{class:c.opItem},[d("div",{class:c.opLabel},"\u9879\u76EE\u540D\u79F0:"),d(_,{clearable:!0,min:0,onOnEnter(){t._searchProject()},modelValue:h.condition.name,placeholder:"\u6A21\u7CCA\u67E5\u8BE2","onUpdate:modelValue":F=>h.condition.name=F,style:"width: 240px"})])]),d("div",{class:c.opts},d(f,{type:"primary",shape:"circle",icon:"ios-search",onClick:()=>{t._searchProject()}}))]),d(v,{animated:!1,modelValue:t.reactive.type,"onUpdate:modelValue":F=>t.reactive.type=F},()=>[d(D,{label:"\u9879\u76EE",name:"\u9879\u76EE"},()=>d(g,{size:"small",loading:t.reactive.loading,columns:t.reactive.addColumns,data:t.reactive.projectList})),d(D,{label:"\u50A8\u5907\u9879\u76EE",name:"\u50A8\u5907\u9879\u76EE"},()=>d(g,{size:"small",loading:t.reactive.loading,columns:t.reactive.addColumns,data:t.reactive.storeProjectList}))])])},this.context.renderFunctionMap.info=()=>{let g=l("Image"),f=l("Checkbox");if(this.reactive.resourceList.length>0){const{resourceList:E,insertHeader:b}=this.reactive,_=[];return E==null||E.forEach(v=>{console.log("teleport",v),_.push(d(m,{to:v.qs},d("div",{class:`${c.insertDom} ${c[v.class]}`},[r.image(g,v.qrCode),d("div",null,r.info(v)),r.checkbox(f,v,()=>{this._checkbox()})])))}),_.push(d(m,{to:b.to},d("div",{class:c.insertHeaderDom},[d("div",null,b.name),r.checkbox(f,b,v=>{this._checkboxTotal(v)})]))),_}},this.context.renderFunctionMap.modal=()=>{const g=l("Modal");return d(g,{title:"\u5BFC\u5165\u9879\u76EE\u8BE6\u60C5",modelValue:this.reactive.importDetailShow,"onUpdate:modelValue":f=>this.reactive.importDetailShow=f},{default:()=>[...Object.keys(t.reactive.importDetail||[]).map(f=>{const E=[];return f&&t.reactive.importDetail[f]&&(console.log("me.reactive.importDetail[key]",JSON.stringify(t.reactive.importDetail[f])),E.push(d("div",{class:c["import-detail"]},this.selfCall(()=>{const b=[],{extensionImportMap:_,resourceMap:v}=t.reactive.importDetail[f];return console.log("extensionImportMap, resourceMap",_,v),(_||v)&&(b.push(d("div",{class:c["import-project-title"]},`\u9879\u76EE${f}(ID)\u5BFC\u5165\u8D44\u6E90\u8BE6\u60C5`)),v&&b.push(d("div",{},this.selfCall(()=>{const D=[];return Object.keys(v).map(F=>{D.push(d("span",{class:c["import-project-resource-detail"]},`\u8D44\u6E90${F}(ID):${v[F]}`))}),D}))),_&&b.push(d("div",{},this.selfCall(()=>{const D=[];return Object.keys(_).map(F=>{D.push(d("span",{class:c["import-project-extension-detail"]},`\u5F85\u5EFA\u8054${F}(ID):${_[F]}`))}),D})))),b})))),E})]})}}_onVisibleChange(e){console.log("e",e)}selfCall(e){return e()}_checkbox(){this.reactive.insertHeader.checked=this.reactive.resourceList.every(e=>e.checked==!0)}_checkboxTotal(e){this.reactive.resourceList.forEach(s=>{s.checked=e})}async _pushResource(){const{context:e,reactive:s}=this,{type:t,resourceList:a}=s,n=t=="\u9879\u76EE"?"records":"storeRecords",{$Message:c}=e;if(s[n].length>0){console.log("resourceList",a);const r=a.find(l=>l.checked);console.log("selected",r),r?a.find(d=>d.exist.includes("\u672A\u5EFA\u8054")&&d.checked)?(this.reactive.needImportProject=!0,this._batchImport()):this._importResourceToProject():c.warning({content:"\u672A\u9009\u4E2D\u8D44\u6E90\uFF0C\u65E0\u6CD5\u5BFC\u5165"})}else c.warning({content:"\u672A\u9009\u4E2D"+t+"\uFF0C\u65E0\u6CD5\u5BFC\u5165"})}async _importResourceToProject(){const{context:e,reactive:s,options:t,userTabId:a,api:n}=this,{records:c,resourceList:i}=s,{$Message:r}=e;s.needImportProject=!1;const l=[],d=[],p=[];for(let m of i){const{checked:h,resourceId:g,extensionImportId:f,name:E,id:b}=m;h&&(g?d.push(g):f&&(f==1&&this.api.baojing({tag:this.options.tag,message:JSON.stringify(m),site:window.location.href}),p.push(f)))}for(let m of c)l.push(m.id);if(d.length>0||p.length>0){const m={resourceIdList:d,extensionImportIdList:p,opId:a.user.id,isBusinessSupervisor:mt(a.user),origin:t.tag,projectIdList:l},h=await n.projectResource.extensionBatchAdd(m);console.log("res",h);const{code:g,data:f}=h;g==0&&(this.reactive.importDetail=f,this.reactive.importDetailShow=!0,r.success({content:"\u5BFC\u5165\u6210\u529F"}))}}async _batchImport(){const{reactive:e,userTabId:s}=this,{resourceList:t}=e,a=[];for(let n=0;n<t.length;n++){const{exist:c,checked:i,id:r}=t[n];c.includes("\u672A\u5EFA\u8054")&&i&&a.push({index:n,xtId:r})}chrome.runtime.onMessage.addListener((n,c,i)=>{console.log(this.options.tag,"onMessage",n),this._onMessage(n)}),a.length>0?(this.reactive.autoImportList=a,this._autoPatchNext()):this.context.$Message.warning({content:"\u672A\u9009\u4E2D\u8D44\u6E90\uFF0C\u65E0\u6CD5\u6279\u91CF\u6293\u53D6"})}_onMessage(e){console.log("_onMessage",e);const{aim:s,msg:t,res:a}=e;if($.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page==t&&V.\u901A\u77E5\u5DF2\u5165\u5E93==s){const{data:n,form:c,error:i}=a;i?this.context.$Message.warning({content:i.message}):this._updateResourceList(c,n)}}async _searchProject(){let e={};this.reactive.type=="\u9879\u76EE"?(this.reactive.loading=!0,e=await this.api.project.extensionSearch(this.reactive.condition),this.reactive.loading=!1):this.context.$Message.warning({content:"\u50A8\u5907\u9879\u76EE\u529F\u80FD\u6B63\u5728\u5F00\u53D1"});const{code:s,data:t}=e;s==0&&(this.reactive.projectList=t)}_doSelectAll(e){console.log("doSelectAll",e),e.forEach(s=>{this.reactive.records.findIndex(a=>a.id===s.id)<0&&(this.reactive.type=="\u9879\u76EE"?this.reactive.records.push(s):this.reactive.storeRecords.push(s))}),console.log("doSelectAll",this.reactive)}_doUnSelectAll(e){console.log("doUnSelectAll",e),this.reactive.type=="\u9879\u76EE"?this.reactive.records=e:this.reactive.storeRecords=e,console.log("doUnSelectAll",this.reactive)}_doSelect(e){console.log("this",this),console.log("doSelect",e),this.reactive.type=="\u9879\u76EE"?this.reactive.records=e:this.reactive.storeRecords=e,console.log("doSelect",e,this.reactive)}_doUnSelect(e){console.log("doUnSelect",e),this.reactive.type=="\u9879\u76EE"?this.reactive.records=e:this.reactive.storeRecords=e,console.log("doUnSelect",e,this.reactive)}}function gt(o,u){return u.forGaoqu==J.\u68C0\u6D4B\u662F\u5426\u767B\u5F55?new ft(o,u):new bt(o,u)}class ft extends X{constructor(u,e){super(u,e),this._init()}async _init(){let u=!1,e=await this._checkEnv(),s="\u84B2\u516C\u82F1\u73AF\u5883\u68C0\u6D4B\u6B63\u5E38";if(console.log("login",e),e?u=await this.doSomething():s="\u63D2\u4EF6\u672A\u767B\u5F55",console.log("pageLogin",u),e&&u){const{fromTabId:t,tag:a}=this.options;return R(G({tag:a,content:s,pass:u,toTabId:t,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u73AF\u5883\u68C0\u6D4B,closeTab:!0},"\u84B2\u516C\u82F1\u63D2\u4EF6\u73AF\u5883\u68C0\u6D4B"))}}async doSomething(){var t;let u=!1;const{context:e}=this;let s=await e.$bus.subscribe(/solar\/cooperator\/blogger\/v2/,a=>e.$bus.parseBody(a));return console.log("doSomething",s),(t=s.data)!=null&&t.kols&&(u=!0),u}}class bt extends ye{_updateResourceList(u,e){throw new Error("Method not implemented.")}constructor(u,e){super(u,e)}_otherCss(){return{}}async _collectTag(){const{api:u}=this,e=await this.busTagsData(u),s=this.dataHandle(e);console.log("tag",s);const t=ie(s,"contentTags"),a=ie(s,"featureTags"),n=ie(s,"personalTags"),c=ie(s,"liveCategoryTags");n&&a&&t&&c&&await u.extension.pgyTag(s)}_updatePage(){}_autoPatchNext(){}async busTagsData(u){const e=u.ajax.get("https://pgy.xiaohongshu.com/api/solar/cooperator/content/tag_tree"),s=u.ajax.get("https://pgy.xiaohongshu.com/api/solar/kol/get_select_kol_tags_config_v2"),t=u.ajax.get("https://pgy.xiaohongshu.com/api/draco/distributor-square/distributors-tags"),[a,n,c]=await Promise.all([e,s,t]),{personalTags:i,featureTags:r}=n.data,l=a.data,{distribution_category:d}=c.data.distributor_tag_map,p={contentTags:l,featureTags:r,personalTags:i,liveCategoryTags:d};return console.log("busTagsData ok ",p),p}dataHandle(u){const e=this.deconstructionTransformation(u.contentTags),s=this.deconstructionTransformation(u.featureTags),t=this.deconstructionTransformation(u.personalTags),a=this.deconstructionTransformationLive(u.liveCategoryTags),n={contentTags:e,featureTags:s,personalTags:t,liveCategoryTags:a};return console.log("dataHandle ok",n),n}deconstructionTransformation(u){let e=[];return u.forEach(s=>{let t={};s.taxonomy2Tag!="\u6BCD\u5A74\u9636\u6BB5"&&(Object.keys(s).forEach(a=>{s[a]instanceof Array&&s[a].length>0&&(t.tags=s[a])}),s.hasOwnProperty("taxonomy2Tag")&&typeof s.taxonomy2Tag=="string"?t.tag=s.taxonomy2Tag:t.tag=s.taxonomy1Tag,e.push(t))}),e}deconstructionTransformationLive(u){let e=[];return u.forEach(s=>{const{first_category:t,second_category:a}=s;e.push({tag:t,tags:a})}),e}}function Et(o){const{classes:u}=o.createStyleSheet({"@global":{"#crx-app .ivu-card-body":{padding:"0 5px"},".author-page-tab":{zIndex:"10!important"},".ivu-image":{gridColumn:"2 / 5",margin:"2.5px 5px"},...Se},insertItem:{color:"#333",margin:"5px 0px 0px 5px"},insertLabel:{margin:"5px 0px 0px 5px"},insertOpInfoDom:{margin:"16px auto",width:"260px",display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gridAutoFlow:"row",alignItems:"center",color:"rgb(153, 153, 153)",backgroundColor:"rgb(255, 238, 243)",fontWeight:"400",fontSize:"12px",lineHeight:"18px",borderRadius:"8px",gap:"5px"},line1:{textOverflow:"ellipsis",overflow:"hidden"},site:{wordBreak:"break-all"},photo:{width:"30px",height:"30px",borderRadius:"50%"},submit:{marginTop:"10px",width:"100%","&:before":{content:'"icon"'}},mainLabel:{color:"rgb(0, 0, 255)",fontWeight:"bold"},label:{color:"rgb(45, 140, 240)"},title:{color:"rgb(161 23 190)",textAlign:"center",borderRadius:"5px",backgroundColor:"#f6e5f6",fontWeight:700},gaoqu:be}).attach();return{classes:u,render:{title(s){return`<div class="${u.title}">${s}</div>`},label(s){return`<label class="${u.label}">${s}</label>`},mainLabel(s){return`<label class="${u.mainLabel}">${s}</label>`},site(s){return`<div class="${u.site}">${s}</div>`},photo(s){return`<img src="${s}" class="${u.photo}"/>`}}}}class me extends X{constructor(e,s){super(e,s);j(this,"form");j(this,"reactive");j(this,"it");j(this,"classes");j(this,"render");j(this,"_submitServer",async()=>{let{context:e,form:s,reactive:t,userTabId:a,api:n}=this;if(a.user){let c=this._validateSubmit(s);if(console.log("import-form",c,s),c){let{id:i,token:r}=a.user;s.opId=i,this._beforeSubmit(s),t.submitting=!0;let{code:l,data:d,msg:p}=await n.extension.import(this._makeParams(s),r);if(t.submitting=!1,l===0){this._afterSubmit(s,d);let{content:m,type:h}=d;if(h==="success")return e.$Message.success({content:m}),t.data[0].record=m,t.showModal=!1,!0;h=="warning"?e.$Notice.warning({title:"\u8BF7\u6CE8\u610F",desc:m}):e.$Notice.error({title:"\u8BF7\u6CE8\u610F",desc:m,duration:6})}else e.$Notice.error({title:"\u9047\u5230\u95EE\u9898-_-!",desc:p})}this._ending(s)}else e.$Message.success("\u8BF7\u5148\u767B\u5F55");return!1});j(this,"_tryCollectTimeout",()=>new Promise(e=>{this.it=setTimeout(()=>{e(this._tryCollect())},1e3)}));this._init()}async _init(){await this._checkEnv()&&(this._css(),await this._prepareUser(),this._view(),this.userTabId.user?this._autoCollect():this.context.$Notice.error({title:"\u8BF7\u5148\u767B\u5F55\u63D2\u4EF6",desc:"\u767B\u5F55\u63D2\u4EF6\u540E\u624D\u80FD\u6B63\u5E38\u4F7F\u7528"}))}_css(){let{$jss:e}=this.context,{classes:s,render:t}=Et(e);this.classes=s,this.render=t}_basicView(e){return{align:"middle",gutter:0,subList:[{span:4,html:this.render.label("\u5934\u50CF")},{span:4,html:this.render.photo(e.photo)},{span:16,html:e.uid,className:this.classes.line1},{span:4,html:this.render.label("\u6635\u79F0")},{span:4,html:e.name},{span:4,html:this.render.label("\u5A92\u4F53\u53F7")},{span:4,html:e.mediaId},{span:4,html:this.render.label("\u6765\u6E90")},{span:4,html:e.origin},{span:4,html:this.render.label("\u5E73\u53F0")},{span:4,html:e.platform},{span:4,html:this.render.label("\u5730\u533A")},{span:4,html:e.region},{span:4,html:this.render.label("IP\u5C5E\u5730")},{span:4,html:e.ip},{span:4,html:this.render.label("\u7C89\u4E1D\u6570")},{span:4,html:e.fanCount},{span:4,html:this.render.label("\u83B7\u8D5E\u6570")},{span:4,html:e.greatCount},{span:4,html:this.render.label("mcn")},{span:4,html:e.mcn},{span:4,html:this.render.label("\u4E3B\u9875")},{span:20,html:this.render.site(e.site)}]}}async _autoCollect(){var t;let{ok:e,data:s}=await this._doCollect();console.log("autoCollect",e,s),e?this._validateAuto(s)&&(console.log("this.reactive.user",this.userTabId.user),s.autoOpId=(t=this.userTabId.user)==null?void 0:t.id,this.form=s,await this._autoServer(s)):this._ending(s||{})}_makeParams(e){return e}async _autoServer(e){let{context:s,options:t,reactive:a,api:n,userTabId:c}=this;console.log("auto-token",c.user.token);let i=this._makeParams(e);this._beforeAuto(i);let r=await n.extension.auto(i);if(r){let{code:l,data:d,msg:p}=r;if(l===0){console.log("path",t.grab==pe.\u6293\u53D6\u5168\u90E8\u6570\u636E),console.log("options.grab",t.grab),console.log("Grab.\u6293\u53D6\u5168\u90E8\u6570\u636E",pe.\u6293\u53D6\u5168\u90E8\u6570\u636E),t.grab==pe.\u6293\u53D6\u5168\u90E8\u6570\u636E?await this._afterAuto(e,d):this._afterAuto(e,d);const{ids:m,table:h}=d;if(h==le.\u63D2\u4EF6\u5165\u5E93){let g=`\u5F85\u5EFA\u8054/${m.join(",")}`;s.$Message.success({content:g}),a.data[0].record=g}else if(h==le.\u8D44\u6E90\u5165\u5E93){let g=`\u8D44\u6E90/${m.join(",")}`;s.$Message.success({content:g}),a.data[0].record=g}else if(h==le.\u54C1\u724C\u5165\u5E93){let g=`\u54C1\u724C/${m.join(",")}`;a.data[0].record=g}else a.data[0].record="\u{1F21A}\uFE0F"}else s.$Notice.error({title:"\u9047\u5230\u95EE\u9898-_-!",desc:p}),l==-35&&this._signOut();this._ending(i)}}async _collect(){if(this.userTabId.user){if(!this.form){let{ok:e,data:s}=await this._doCollect();console.log("collect",e,s),e&&(this.form=s)}this.form.autoOpId=this.userTabId.user.id,this.reactive.viewList=this._formMeta(this.form),this.reactive.showModal=!0}else this.context.$Message.success("\u8BF7\u5148\u767B\u5F55")}async _doCollect(){let e=await this._tryCollect();if(console.log("tryCollect",e),!e.ok){let s=1,t=5;for(;s<t;)e=await this._tryCollectTimeout(),console.log("tryCollectTimeout",s,e),e.ok?s=t:s++}return e.ok||this.context.$Message.error({content:"\u83B7\u53D6\u6570\u636E\u5F02\u5E38"}),e}async _tryCollect(){if(this.options.forDebug)return{ok:!0,data:await this._parser()};try{return{ok:!0,data:await this._parser()}}catch(e){return{ok:!1,error:e}}}_cardMeta(){let e=this,{$resolveComponent:s}=this.context;return{columns:[{type:"index",align:"center",width:30},{title:"\u529F\u80FD",width:60,align:"center",key:"desc"},{title:"\u64CD\u4F5C",align:"center",render(t,a){let{desc:n,record:c}=a.row;if(n=="\u66F4\u65B0")return t("span",{class:"active"},{default(){return c||"\u9759\u9ED8\u5F00\u542F"}});if(n=="\u5165\u5E93")return t(s("Button"),{icon:"md-locate",size:"small",onClick(){e._collect()}})}}],data:[{desc:"\u66F4\u65B0",record:""},{desc:"\u5165\u5E93"}]}}_afterLogin(){this._autoCollect()}async _view(){let{context:e,classes:s,_submitServer:t,_signOut:a,userTabId:n}=this,{columns:c,data:i}=this._cardMeta(),{$resolveComponent:r,$h:l,$Teleport:d}=e,p=e.$reactive({showModal:!1,submitting:!1,data:i,title:"",viewList:[],infoList:[],total:8});this.reactive=p,e.renderFunctionMap.card=function(){const h=r("Table"),g=r("Card"),f=r("Icon");return l(g,{},{title(){let E=[l("img",{src:e.src,class:s.gaoqu})];return n.user&&E.push(n.user.name+"("+n.user.id+")"),E},extra(){if(n.user)return l("div",{onClick:a},[l(f,{type:"md-exit",size:13}),"\u767B\u51FA"]);if(n.tabId)return l("a",{href:n.href,target:"_blank"},[l(f,{type:"md-contact",size:13}),"\u767B\u5F55"])},default(){return l(h,{size:"small",columns:c,data:p.data})}})},e.renderFunctionMap.form=function(){let h=r("Row"),g=r("Col"),f=r("Button"),E=r("Modal");return l(E,{modelValue:p.showModal,"onUpdate:modelValue"(b){p.showModal=b},draggable:!0,scrollable:!0,footerHide:!0,mask:!1,width:800},{header(){return p.title},default(){return[...p.viewList.map(b=>{let{gutter:_,align:v,subList:D}=b;return l(h,{gutter:_,align:v},()=>D.map(F=>{let{span:C,offset:I,className:M,html:O}=F;return l(g,{span:C,offset:I,className:M,innerHTML:O})}))}),l(f,{type:"primary",loading:p.submitting,onClick:t,class:s.submit},()=>"\u6DFB\u52A0(\u6216\u66F4\u65B0)\u81F3OP")]}})};const m=this._getElClass();if(m){const h=document.createElement("div"),g=s.insertOpInfoDom;h.className=g,console.log("elClass",m);const f=await ue(4e3,()=>document.querySelector(m));f==null||f.before(h),e.renderFunctionMap.info=function(){let E=r("Image"),b=r("Button");const _=[];for(let v of p.infoList){const{type:D,src:F,value:C,style:I}=v;D=="img"?(_.push(l("div",{class:s.insertLabel},v.label)),_.push(l(E,{src:F,fit:"contain",preview:!0,previewList:[F],initialIndex:0}))):D=="button"?_.push(l(b,{style:I,type:"primary"},{default(){return C}})):(_.push(l("div",{class:s.insertLabel},v.label)),_.push(l("div",{class:s.insertItem},C)))}return l(d,{to:"."+g},_)}}}_beforeSubmit(e){}_afterSubmit(e,s){return this._insertDom(s),this._otherCollect(e,s)}_beforeAuto(e){}_afterAuto(e,s){return this._insertDom(s),this._otherCollect(e,s)}_insertDom(e){if(this._getElClass()){const{table:t,resourceList:a}=e;let n=[];const c={label:"\u5EFA\u8054\u72B6\u6001",value:""};if(console.log(e),t)if(t==le.\u63D2\u4EF6\u5165\u5E93)c.value="\u5F85\u5EFA\u8054",n.push(c);else{c.value="\u5DF2\u5EFA\u8054";let{directWise:i,publication:r,rebate:l,qyGgCode:d,qyWxCode:p,qyBdCode:m}=a[0];n=[c,{label:"\u76F4\u8054\u8FBE\u4EBA:",value:i==null?"--":i,type:"text"},{label:"\u520A\u4F8B\u72B6\u6001:",value:r||"--",type:"text"},{label:"\u8FD4\u70B9\u6BD4\u4F8B:",value:(l||"--")+"%",type:"text"}],p&&n.push({label:"\u7535\u5546:",src:ee(p),type:"img"}),d&&n.push({label:"\u5E7F\u544A:",src:ee(d),type:"img"}),m&&n.push({label:"\u672C\u5730:",src:ee(m),type:"img"})}else c.value="\u672A\u5EFA\u8054",n.push(c);n.push({type:"button",value:"\u5F85\u5F00\u53D1",cb:()=>{console.log("\u5F85\u5F00\u53D11")},style:"grid-column: 1 / 3"}),n.push({type:"button",value:"\u5F85\u5F00\u53D1",cb:()=>{console.log("\u5F85\u5F00\u53D12")},style:"grid-column: 3 / 5;"}),this.reactive.infoList=n,console.log("infoList",n)}}_otherCollect(e,s){return console.debug("void otherCollect"),Promise.resolve()}_getElClass(){return""}}class _t extends me{constructor(e,s){super(e,s);j(this,"total");this.total=8}async _parser(){let{uid:e,site:s,platformSite:t}=Dt();const{sex:a,mcn:n,name:c,photo:i,level:r,price:l,region:d,mediaId:p,fanCount:m,greatCount:h,featureTags:g,contentTags:f,personalTags:E,subContentTags:b}=await this.basePortData(e);let _=await this.portNoteData(e);const{fansMap:v}=_;let{capability:D,dataOverview:F,otherData:C}=await this.portLiveData(_.capability,_.dataOverview,e);vt(D,l),console.log("dataOverview",F);const I={mcn:n,uid:e,sex:a,site:s,name:c,level:r,price:l,photo:i,region:d,mediaId:p,version:this.options.version,fanCount:m,greatCount:h,contentTags:f,featureTags:g,dataOverview:F,capability:D,platformSite:t,personalTags:E,subContentTags:b,otherData:C,origin:"\u84B2\u516C\u82F1",platform:"\u5C0F\u7EA2\u4E66",fansMap:v};return console.log("dataOverview",JSON.stringify(I)),I}_formMeta(e){var n,c,i,r;let{options:s,reactive:t}=this;t.title=`\u8D44\u6E90\u57FA\u672C\u4FE1\u606F(${s.version})`;const a=te(e.price,this.render);return[this._basicView(e),{align:"middle",gutter:0,subList:[...a,{span:4,html:this.render.label("\u6027\u522B")},{span:4,html:e.sex},{span:4,html:this.render.label("\u84B2\u516C\u82F1\u7B49\u7EA7")},{span:4,html:e.level}]},{align:"middle",gutter:0,subList:[{span:4,html:this.render.label("\u4ECB\u7ECD")},{span:20,html:e.introduce},{span:4,html:this.render.label("\u4E00\u7EA7\u5185\u5BB9")},{span:20,html:(n=e.contentTags)==null?void 0:n.join(",")},{span:4,html:this.render.label("\u4E8C\u7EA7\u5185\u5BB9")},{span:20,html:(c=e.subContentTags)==null?void 0:c.join("")},{span:4,html:this.render.label("\u5185\u5BB9\u7279\u5F81")},{span:20,html:(i=e.featureTags)==null?void 0:i.join(",")},{span:4,html:this.render.label("\u7279\u8272\u4EBA\u8BBE")},{span:20,html:(r=e.personalTags)==null?void 0:r.join(",")}]}]}_makeParams(e){const{price:s,dataOverview:t,capability:a,...n}=e;return{...n,price:JSON.stringify(s),dataOverview:JSON.stringify(t),capability:JSON.stringify(a)}}_validateAuto(e){return!e.mediaId||!e.version?(this.context.$Notice.error({title:"\u9047\u5230\u95EE\u9898-_-!",desc:"\u6570\u636E\u4E0D\u5B8C\u5907"}),!1):!0}_validateSubmit(e){if(De(this.userTabId.user)){const{fanCount:s,bloggerId:t,brand:a}=e;if(s<5e3&&t!="63fc2548000000002901430b"&&!a)return this.context.$Notice.warning({title:"\u7C89\u4E1D\u91CF\u4F4E",desc:"\u5C0F\u7EA2\u4E66\u7C89\u4E1D\u91CF\u4E0D\u4F4E\u4E8E5000\u624D\u53EF\u5165\u5E93"}),!1}return e.pass=!0,!0}_ending(e){const{options:s}=this,{tag:t,gaoqId:a,fromId:n,fromTabId:c,forGaoqu:i}=s;if(c&&c>0&&i==J.\u83B7\u53D6\u84B2\u516C\u82F1\u7B49\u7EA7&&a){let{mediaId:r,name:l,level:d}=e;return R(G({title:"\u5C0F\u7EA2\u4E66\u53F7:"+l+"("+r+")",message:"\u7B49\u7EA7:"+d,msg:$.content\u53D1\u9001\u7ED9background,aim:V.\u7CFB\u7EDF\u901A\u77E5},t)),R(G({id:a,res:e?e.level:"\u535A\u4E3B\u4E0D\u5B58\u5728\u6216\u7F51\u7EDC\u9519\u8BEF",toTabId:c,toId:n,data:e,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u8865\u4E01,closeTab:!0},t))}else if(c&&c>0&&i==J.\u56DE\u586B\u57FA\u7840\u6570\u636E&&n)return R(G({data:e,toTabId:c,toId:n,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u63D0\u53D6,closeTab:!0},t))}async basePortData(e){try{const t=(await this.api.ajax.get("https://pgy.xiaohongshu.com/api/solar/cooperator/user/blogger/"+e)).data;let{gender:a,fansCount:n,fansNum:c,personalTags:i,featureTags:r,location:l,name:d,headPhoto:p,currentLevel:m,noteSign:h,pictureShowState:g,videoShowState:f,videoPrice:E,picturePrice:b,redId:_,likeCollectCountInfo:v}=t;a=="\u672A\u77E5"&&(a=null),console.log("bloggerData",t),i=i||[];let{contentTags:D,subContentTags:F}=Ct(t.contentTags);const C=m==0?"\u5F02\u5E38":m==1?"\u666E\u901A":"\u4F18\u79C0",I={\u56FE\u6587\u7B14\u8BB0\u4E00\u53E3\u4EF7:g?b:0,\u89C6\u9891\u7B14\u8BB0\u4E00\u53E3\u4EF7:f?E:0},M=h?h.name:"",O={sex:a,mcn:M,name:d,photo:p,level:C,price:I,region:l,mediaId:_,fanCount:c,greatCount:v,featureTags:r,contentTags:D,personalTags:i,subContentTags:F,uid:e};return console.log("basePortData ok",O),O}catch{return console.log("basePortData ok","\u9519\u8BEF"),null}}async portRequest(e,s,t=5){let a=null;try{a=await this.api.ajax.get(e),console.log("url",e),console.log("response",a);const n=a.data.hasOwnProperty(s);if(console.log("pass",n),!n)throw new Error("data\u6570\u636E\u51FA\u9519")}catch(n){t>0||this.api.baojing({tag:this.options.tag,error:n==null?void 0:n.message,at:`portRequest ${e}`,url:window.location.href})}return a}async portLiveData(e,s,t){const a=`https://pgy.xiaohongshu.com/api/solar/kol/kIntention/live/card?kolUserId=${t}`,n=`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/liveSummary?userId=${t}&dateType=`,c=this.portRequest(n+1,"fansNum"),i=this.portRequest(n+2,"fansNum"),r=this.portRequest(a,"fansNum"),[l,d,p]=await Promise.all([c,i,r]),m={live1m:l,live3m:d},h={live1m:{suffix:"1m"},live3m:{suffix:"3m"}};Object.keys(m).forEach(E=>{const b=m[E].data,_=h[E].suffix;b&&(e["averageSales"+_]=z(b,"averageSales"),e["overAverageSalesBuyers"+_]=z(b,"overAverageSalesBuyers",1e4),e["totalSales"+_]=z(b,"totalSales"),e["overTotalSalesBuyers"+_]=z(b,"overTotalSalesBuyers",1e4),e["liveGpm"+_]=z(b,"liveGpm",100),e["overLiveGpmBuyers"+_]=z(b,"overLiveGpmBuyers",1e4),e["numberOfOromotedProducts"+_]=z(b,"numberOfOromotedProducts"),e["numberOfPartnerSeller"+_]=z(b,"numberOfPartnerSeller"),e["newFansNum"+_]=z(b,"newFansNum"),e["proportionOfActiveFans"+_]=z(b,"proportionOfActiveFans",1e4),e["overBuyerForProportionOfActiveFans"+_]=z(b,"overBuyerForProportionOfActiveFans",1e4),e["overBuyerForProportionOfOrderFans"+_]=z(b,"overBuyerForProportionOfOrderFans",1e4),e["proportionOfOrderFans"+_]=z(b,"proportionOfOrderFans",1e4),e["fanUnitPrice"+_]=z(b,"fanUnitPrice",100),e["liveDays"+_]=z(b,"liveDays"),e["liveCount"+_]=z(b,"liveCount"),e["averageViewTime"+_]=z(b,"averageViewTime"),e["viewMiddleCount"+_]=z(b,"viewMiddleCount"),e["interactionRate"+_]=z(b,"interactionRate",1e4),e["maxOnlineViewer"+_]=z(b,"maxOnlineViewer"))});const g=p.data,f={};if(g!=null&&g.cooperationStatus){const{canDiscuss:E,cooperationStatus:b,cooperativeCondition:_,intentionalCommission:v,kolSelectionDirectionList:D,livePlan:F}=g;e.canDiscuss=E,e.cooperationStatus=b,e.cooperativeCondition=_,e.intentionalCommission=+v;let C=[];D!=null&&D.length&&(D.forEach(M=>{const{firstSelectionDirection:O,secondProductDirection:N,secondStyleDirection:S}=M;O&&C.push(O),N&&(C=[...C,...N]),S&&(C=[...C,...S])}),e.selectionDirection=C.join("\u3001"));const I=[];F!=null&&F.length&&F.forEach(M=>{let{endTime:O,livePlanId:N,merchantId:S,planGoodsCount:k,reservationNumber:y,selectedGoodsCount:U,showStatus:x,startTime:T,title:H}=M;if(y){let A=y.match(/(\d+)/);console.log("match",A),A?y=+A[1]:y=0}else y=0;const L={endTime:oe(new Date(O)),startTime:oe(new Date(T)),livePlanId:N,merchantId:S,planGoodsCount:k,reservationNumber:y,selectedGoodsCount:U,showStatus:x,title:H};I.push(L)}),console.log("nextJs-data-livePlan",{livePlan:F,resourceLivePlanList:I}),I.length>0&&(f.buyerLivePlanList=I)}return console.log("portLiveData",{capability:e,dataOverview:s}),{capability:e,dataOverview:s,otherData:f}}async portNoteData(e){const s=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/dataSummary?userId=${e}&business=0`,"noteNumber"),t=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/dataSummary?userId=${e}&business=1`,"noteNumber"),a=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/notesRate?userId=${e}&business=0&noteType=3&dateType=1&advertiseSwitch=1`,"noteNumber"),n=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/notesRate?userId=${e}&business=1&noteType=3&dateType=1&advertiseSwitch=1`,"noteNumber"),c=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/notesRate?userId=${e}&business=0&noteType=3&dateType=2&advertiseSwitch=1`,"noteNumber"),i=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/notesRate?userId=${e}&business=1&noteType=3&dateType=2&advertiseSwitch=1`,"noteNumber"),r=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/notesRate?userId=${e}&business=0&noteType=3&dateType=1&advertiseSwitch=0`,"noteNumber"),l=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/notesRate?userId=${e}&business=1&noteType=3&dateType=1&advertiseSwitch=0`,"noteNumber"),d=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/notesRate?userId=${e}&business=0&noteType=3&dateType=2&advertiseSwitch=0`,"noteNumber"),p=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/notesRate?userId=${e}&business=1&noteType=3&dateType=2&advertiseSwitch=0`,"noteNumber"),m=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/dataV3/fansSummary?userId=${e}`,"fansNum"),h=this.portRequest(`https://pgy.xiaohongshu.com/api/solar/kol/data/${e}/fans_profile`,"gender");let g={};const f={};let E=null;const[b,_,v,D,F,C,I,M,O,N,S,k]=await Promise.all([s,t,a,n,r,l,d,p,m,h,c,i]);console.log("promiseData",{dailyNotes:b,cooperationNotes:_,notesDailyRate:v,notesCooperationRate:D,zrNotesDailyRateV2:I,zrNotesCooperationRateV2:M,zrNotesDailyRate:F,zrNotesCooperationRate:C,fansSummary:O,fansProfile:N,notesDailyRateV2:S,notesCooperationRateV2:k}),b&&_&&b.data&&_.data&&(g.\u6570\u636E\u6982\u89C8=At(b.data,_.data,f)),v&&D&&v.data&&D.data&&F&&C&&F.data&&C.data&&(g["\u4F20\u64AD\u8868\u73B0(30\u5929)"]=Bt(v.data,D.data,F.data,C.data,f)),S&&k&&S.data&&k.data&&I&&M&&I.data&&M.data&&(g["\u4F20\u64AD\u8868\u73B0(90\u5929)"]=xt(S.data,k.data,I.data,M.data,f)),O&&N&&O.data&&N.data&&(g.\u7C89\u4E1D\u5206\u6790=yt(O.data,N.data,f),E=wt(N.data));const y={dataOverview:g,capability:f,fansMap:E};return console.log("portData ok",y),console.log("capability ok",JSON.parse(JSON.stringify(f))),y}async notesCollect(e){const{options:s,context:t,api:a}=this,{tag:n}=s,{mediaId:c,uid:i,origin:r,platform:l,fansMap:d}=e;let p={mediaId:c,uid:i,origin:r,platform:l,fansMap:d};a.fansPgy.addOrUpdate(p);let m=[];const h=8,g=await Y(a,xe(1,i,10),"list",n),f=g?g.data.total:null;if(f>h){const{data:E}=await Y(a,xe(1,i,f),"list",n);m=E.list}else m=g.data.list;if(console.log("notes1",m),m.length>0)for(let E of m){const{isAdvertise:b,isVideo:_,noteId:v}=E;if(E.isAdvertise=b?1:0,E.isVideo=_?1:0,b){const{code:D,data:F}=await Y(a,Ft(v),"reportBrandUserId",n);E.brandXhsCode=F.reportBrandUserId}}return console.log("notes2",m),p.noteCollectList=m,await a.notesCollect.addOrUpdate(p),"ok"}async liveCollect(e,s){const{options:t,context:a,api:n}=this,{tag:c}=t,{uid:i,otherData:r}=e,{buyerLivePlanList:l}=r;console.log("resourceId",s),l&&this.api.buyerLivePlan.addOrUpdate({buyerLivePlanList:l,uid:i,resourceId:s});const d={buyer_id:i,date_type:1,page:1,first_live_category:"",second_live_category:"",size:10},p=Y(n,ne("category"),"buyer_coo_categories_analysis_infos",c,d),m=Y(n,ne("item"),"buyer_coo_categories_analysis_infos",c,d),h=Y(n,ne("shop"),"buyer_coo_categories_analysis_infos",c,d);d.date_type=2;const g=Y(n,ne("category"),"buyer_coo_categories_analysis_infos",c,d),f=Y(n,ne("item"),"buyer_coo_categories_analysis_infos",c,d),E=Y(n,ne("shop"),"buyer_coo_categories_analysis_infos",c,d),[b,_,v,D,F,C]=await Promise.all([p,h,m,g,E,f]);console.log("categoryData3m, shopData3m, itemData3m",D,F,C),console.log("categoryData1m, shopData1m, itemData1m",b,_,v);let I={category_1:{size:b.data.total,listKey:"buyer_coo_categories_analysis_infos",list:b.data.buyer_coo_categories_analysis_infos,promise:null},item_1:{size:v.data.total,listKey:"buyer_coo_product_analysis_infos",list:v.data.buyer_coo_product_analysis_infos,promise:null},shop_1:{size:_.data.total,listKey:"buyer_coo_shop_analysis_infos",list:_.data.buyer_coo_shop_analysis_infos,promise:null},category_2:{size:D.data.total,listKey:"buyer_coo_categories_analysis_infos",list:D.data.buyer_coo_categories_analysis_infos,promise:null},item_2:{size:C.data.total,listKey:"buyer_coo_product_analysis_infos",list:C.data.buyer_coo_product_analysis_infos,promise:null},shop_2:{size:F.data.total,listKey:"buyer_coo_shop_analysis_infos",list:F.data.buyer_coo_shop_analysis_infos,promise:null}};console.log("configData-init",JSON.parse(JSON.stringify(I))),Object.keys(I).forEach(x=>{const{size:T}=I[x];if(T>10){const H=x.split("_"),L=H[0],A=H[1];I[x].promise=Y(n,ne(L),"buyer_coo_categories_analysis_infos",c,{...d,size:T,date_type:A})}}),console.log("configData-Object.keys",JSON.parse(JSON.stringify(I)));const M=[],O=[];Object.keys(I).forEach(x=>{const{promise:T,list:H,listKey:L}=I[x];O.push({key:x,listKey:L}),T?M.push(T):M.push(H)});const N=await Promise.all(M);console.log("liveDataList",N),console.log("configData-Object.keys",I);const S={};N.forEach((x,T)=>{const{key:H,listKey:L}=O[T];console.log("key",H),console.log("item",x);const A=x.data?x.data[L]:x,P=H.split("_"),w=P[0],B=P[1];A.forEach(q=>{q.date_type=+B}),S.hasOwnProperty(w)?S[w]=[...S[w],...A]:S[w]=A}),console.log("params",S);const{category:k,item:y,shop:U}=S;if(k&&k.length>0){const x=[],T=[],H=k.map(A=>{const{first_category_name:P,second_category_name:w}=A;return x.includes(P)||x.push(P),T.includes(P)||T.push(w),A.avg_price=A.avg_price?+A.avg_price.toFixed(2):0,A.sale_amount=A.sale_amount?+A.sale_amount.toFixed(2):0,A}),L={subLiveCategoryTags:T,liveCategoryTags:x,resourceId:s};console.log("paramsAddLiveCategoryTag",L),this.api.resourceTag.addLiveCategoryTag(L),this.api.liveCategory.updateOrInsert({liveCategoryList:H,uid:i,resourceId:s})}if(y&&y.length>0){const x=y.map(T=>(T.price=T.price?+T.price.toFixed(2):0,T));this.api.liveProduct.updateOrInsert({liveProductList:x,uid:i,resourceId:s})}if(U&&U.length>0){const x=U.map(T=>(T.avg_price=T.avg_price?+T.avg_price.toFixed(2):0,T));this.api.liveShop.updateOrInsert({liveShopList:x,uid:i,resourceId:s})}return console.log("configData-Promise.all",I),"ok"}async _otherCollect(e,s){const{ids:t,table:a}=s;if(console.log("data",s),a&&t&&a==le.\u8D44\u6E90\u5165\u5E93){const{$Notice:n}=this.context;n.warning({title:"\u8BF7\u7A0D\u7B49",desc:"\u6B63\u5728\u63D0\u53D6\u535A\u4E3B\u7B14\u8BB0\u6570\u636E...."});const c=t[0],i=this.notesCollect(e);console.log("resourceId",c);const r=this.liveCollect(e,c);await Promise.all([i,r]),n.success({title:"\u63D0\u53D6\u6210\u529F",desc:"\u535A\u4E3B\u7B14\u8BB0\u6570\u636E\u63D0\u53D6\u6210\u529F\uFF0C\u8C22\u8C22\u60A8\u7684\u7B49\u5F85\uFF01"})}}}function xe(o,u,e){return`https://pgy.xiaohongshu.com/api/solar/kol/dataV2/notesDetail?advertiseSwitch=1&orderType=1&pageNumber=${o}&pageSize=${e}&userId=${u}&noteType=4&withComponent=false`}function Ft(o){return`https://pgy.xiaohongshu.com/api/solar/note/${o}/detail?bizCode=`}function ne(o){return`https://pgy.xiaohongshu.com/api/draco/distributor-square/distributor/cooperative/${o}/v2`}function Dt(){let o=window.location.pathname.split("/");o=o[o.length-1];let{origin:u,pathname:e}=window.location,s=u+e,t=`https://www.xiaohongshu.com/user/profile/${o}`;const a={uid:o,site:t,platformSite:s};return console.log("locationData",a),a}function vt(o,u){const e={cpe1m:0,cpe3m:0,cpe:0,cpm1m:0,cpm3m:0,cpm:0,rccpe1m:0,rccpe3m:0,rccpe:0,rccpm1m:0,rccpm3m:0,rccpm:0,cpv1m:0,cpv3m:0,cpv:0},s=u.\u56FE\u6587\u7B14\u8BB0\u4E00\u53E3\u4EF7;function t(T,H=1){return T?Number((s/T*100*H).toFixed()):0}const{hdzws1m:a,hdzws3m:n,hdzws:c,rchdzws1m:i,rchdzws3m:r,rchdzws:l,bgzws1m:d,bgzws3m:p,rcbgzws1m:m,rcbgzws3m:h,ydzws1m:g,ydzws3m:f,ydzws:E,rcydzws1m:b,rcydzws3m:_,rcydzws:v,zrhdzws1m:D,zrhdzws3m:F,zrrchdzws1m:C,zrrchdzws3m:I,zrbgzws1m:M,zrbgzws3m:O,zrrcbgzws1m:N,zrrcbgzws3m:S,zrydzws1m:k,zrydzws3m:y,zrrcydzws1m:U,zrrcydzws3m:x}=o;s&&(e.cpe1m=t(a),e.zrcpe1m=t(D),e.cpe3m=t(n),e.zrcpe3m=t(F),e.cpe=t(c),e.rccpe1m=t(i),e.zrrccpe1m=t(C),e.rccpe3m=t(r),e.zrrccpe3m=t(I),e.rccpe=t(l),e.cpv1m=t(g),e.zrcpv1m=t(k),e.cpv3m=t(f),e.zrcpv3m=t(y),e.cpv=t(E),e.rccpv1m=t(b),e.zrrccpv1m=t(U),e.rccpv3m=t(_),e.zrrccpv3m=t(x),e.rccpv=t(v),e.cpm1m=t(d,1e3),e.zrcpm1m=t(M,1e3),e.cpm3m=t(p,1e3),e.zrcpm3m=t(O,1e3),e.cpm=0,e.rccpm1m=t(m,1e3)>2147483648?2147483600:t(m,1e3),e.zrrccpm1m=t(m,1e3)>2147483648?2147483600:t(N,1e3),e.rccpm3m=t(h,1e3)>2147483648?2147483600:t(h,1e3),e.zrrccpm3m=t(h,1e3)>2147483648?2147483600:t(S,1e3),e.rccpm=0),Object.assign(o,e)}function Ct(o){let u=[],e=[];return o&&o.forEach(s=>{Object.keys(s).forEach(t=>{const a=s[t];a instanceof Array?a.forEach(n=>{e.push(n)}):typeof a=="string"&&u.push(a)})}),{contentTags:u,subContentTags:e}}function ce(o,u,e){let s="",t=0;if(Array.isArray(o))o.forEach(a=>{const n=a[e];t<n&&(t=n,s=a[u])});else return{label:"",value:0};return{label:s,value:Math.ceil(t*100)}}function wt(o){let u={};for(let e in o)o[e]!=null&&(u[e]=JSON.stringify(o[e]));return u}function ge(o,u){u.sort(function(s,t){return s.percent<t.percent?1:s.percent>t.percent?-1:0});const e=[];for(let s=0;s<u.length;s++){const{name:t,percent:a,desc:n}=u[s],c={title:`TOP${s+1}${o}`,name:t,percent:(a*100).toFixed(2)};if(n&&(delete c.name,c.desc=n),s>4)break;e.push(c)}return e}function yt(o,u,e){let{fansIncreaseNum:s,fansGrowthRate:t,activeFansRate:a,readFansRate:n,engageFansRate:c}=o,{ages:i,cities:r,devices:l,gender:d,interests:p,provinces:m}=u;const h=ce(i,"group","percent"),g=ce(r,"name","percent"),f=ce(l,"desc","percent"),E=ce(p,"name","percent"),b=ce(m,"name","percent");let{male:_,female:v}=d,D="";typeof _=="number"&&typeof(v=="number")&&(D=_>=v?`\u7537\u6027(${Math.ceil(_*100)}%)`:`\u5973\u6027(${Math.ceil(v*100)}%)`),console.log("fansGrowthRate",t);const F={fsKey:h.label+`(${h.value}%)`+g.label+`(${g.value}%)`+f.label+`(${f.value}%)`+E.label+`(${E.value}%)`+b.label+`(${b.value}%)`+D,fszl:s-0,fslbhfd:(t-0)*100,hyfszb:a-0,ydfszb:n-0,hdfszb:c-0,fsMaleRate:Math.ceil(_*100),fsFemaleRate:100-Math.ceil(_*100),nlfbMax:h.label,nlfbRate:h.value,csfbMax:g.label,csfbRate:g.value,sbfbMax:f.label,sbfbRate:f.value,yhxqMax:E.label,yhxqRate:E.value,sffbMax:b.label,sffbRate:b.value},C={ages:i.map(I=>{const{percent:M,group:O}=I;return{percent:`${(M*100).toFixed(2)}`,group:O}}),cities:ge("\u57CE\u5E02",r),devices:ge("\u7C89\u4E1D\u8BBE\u5907",l),interests:ge("\u7528\u6237\u5174\u8DA3",p),provinces:ge("\u7701\u4EFD",m)};return e.fsKeyJson=JSON.stringify(C),Object.assign(e,F),{\u7C89\u4E1D\u753B\u50CF:{\u5E74\u9F84\u5206\u5E03:i,\u57CE\u5E02\u5206\u5E03:r,\u8BBE\u5907\u5206\u5E03:l,\u6027\u522B\u5206\u5E03:d,\u7528\u6237\u5174\u8DA3:p,\u7701\u4EFD\u5206\u5E03:m}}}function he(o){return o&&(o=o.map(u=>{let{contentTag:e,percent:s}=u;return{[e+"\u7C7B\u76EE\u5360\u6BD4"]:s}})),o}function Bt(o,u,e,s,t){const a=o.pagePercentVo,n=u.pagePercentVo,c={bgzws1m:u.impMedian-0,ydzws1m:u.readMedian-0,hdzws1m:u.mEngagementNum-0,zwdzl1m:u.likeMedian-0,zwscl1m:u.collectMedian-0,zwpll1m:u.commentMedian-0,zwfxl1m:u.shareMedian-0,hdl1m:u.interactionRate-0,spwbl1m:u.videoFullViewRate-0,tw3mydl1m:u.picture3sViewRate-0,qzbjbl1m:u.thousandLikePercent-0,bzbjbl1m:u.hundredLikePercent-0,fbbj1m:u.noteNumber-0,rcbgzws1m:o.impMedian-0,rcydzws1m:o.readMedian-0,rchdzws1m:o.mEngagementNum-0,rczwdzl1m:o.likeMedian-0,rczwscl1m:o.collectMedian-0,rczwpll1m:o.commentMedian-0,rczwfxl1m:o.shareMedian-0,rchdl1m:o.interactionRate-0,rcspwbl1m:o.videoFullViewRate-0,rctw3mydl1m:o.picture3sViewRate-0,rcqzbjbl1m:o.thousandLikePercent-0,rcbzbjbl1m:o.hundredLikePercent-0,rcfbbj1m:o.noteNumber-0,zrbgzws1m:s.impMedian-0,zrydzws1m:s.readMedian-0,zrhdzws1m:s.mEngagementNum-0,zrzwdzl1m:s.likeMedian-0,zrzwscl1m:s.collectMedian-0,zrzwpll1m:s.commentMedian-0,zrzwfxl1m:s.shareMedian-0,zrhdl1m:s.interactionRate-0,zrspwbl1m:s.videoFullViewRate-0,zrtw3mydl1m:s.picture3sViewRate-0,zrqzbjbl1m:s.thousandLikePercent-0,zrbzbjbl1m:s.hundredLikePercent-0,zrfbbj1m:s.noteNumber-0,zrrcbgzws1m:e.impMedian-0,zrrcydzws1m:e.readMedian-0,zrrchdzws1m:e.mEngagementNum-0,zrrczwdzl1m:e.likeMedian-0,zrrczwscl1m:e.collectMedian-0,zrrczwpll1m:e.commentMedian-0,zrrczwfxl1m:e.shareMedian-0,zrrchdl1m:e.interactionRate-0,zrrcspwbl1m:e.videoFullViewRate-0,zrrctw3mydl1m:e.picture3sViewRate-0,zrrcqzbjbl1m:e.thousandLikePercent-0,zrrcbzbjbl1m:e.hundredLikePercent-0,zrrcfbbj1m:e.noteNumber-0};return Object.assign(t,c),{\u65E5\u5E38\u7B14\u8BB0:{\u53D1\u5E03\u7B14\u8BB0:o.noteNumber,\u5185\u5BB9\u7C7B\u76EE\u53CA\u5360\u6BD4:he(o.noteType),\u5408\u4F5C\u884C\u4E1A:o.tradeNames,\u9605\u8BFB\u91CF\u6765\u6E90:a?{\u53D1\u73B0\u9875:a.readHomefeedPercent,\u641C\u7D22\u9875:a.readSearchPercent,\u5173\u6CE8\u9875:a.readFollowPercent,\u535A\u4E3B\u4E2A\u4EBA\u9875:a.readDetailPercent,\u9644\u8FD1\u9875:a.readNearbyPercent,\u5176\u4ED6:a.readOtherPercent}:"",\u66DD\u5149\u91CF\u6765\u6E90:a?{\u53D1\u73B0\u9875:a.impHomefeedPercent,\u641C\u7D22\u9875:a.impSearchPercent,\u5173\u6CE8\u9875:a.impFollowPercent,\u535A\u4E3B\u4E2A\u4EBA\u9875:a.impDetailPercent,\u9644\u8FD1\u9875:a.impNearbyPercent,\u5176\u4ED6:a.impOtherPercent}:""},\u5408\u4F5C\u7B14\u8BB0:{\u53D1\u5E03\u7B14\u8BB0:u.noteNumber,\u5185\u5BB9\u7C7B\u76EE\u53CA\u5360\u6BD4:he(u.noteType),\u5408\u4F5C\u884C\u4E1A:u.tradeNames,\u9605\u8BFB\u91CF\u6765\u6E90:n?{\u53D1\u73B0\u9875:n.readHomefeedPercent,\u641C\u7D22\u9875:n.readSearchPercent,\u5173\u6CE8\u9875:n.readFollowPercent,\u535A\u4E3B\u4E2A\u4EBA\u9875:n.readDetailPercent,\u9644\u8FD1\u9875:n.readNearbyPercent,\u5176\u4ED6:n.readOtherPercent}:"",\u66DD\u5149\u91CF\u6765\u6E90:n?{\u53D1\u73B0\u9875:n.impHomefeedPercent,\u641C\u7D22\u9875:n.impSearchPercent,\u5173\u6CE8\u9875:n.impFollowPercent,\u535A\u4E3B\u4E2A\u4EBA\u9875:n.impDetailPercent,\u9644\u8FD1\u9875:n.impNearbyPercent,\u5176\u4ED6:n.impOtherPercent}:""}}}function xt(o,u,e,s,t){const a=o.pagePercentVo,n=u.pagePercentVo,c={bgzws3m:u.impMedian-0,ydzws3m:u.readMedian-0,hdzws3m:u.mEngagementNum-0,zwdzl3m:u.likeMedian-0,zwscl3m:u.collectMedian-0,zwpll3m:u.commentMedian-0,zwfxl3m:u.shareMedian-0,hdl3m:u.interactionRate-0,spwbl3m:u.videoFullViewRate-0,tw3mydl3m:u.picture3sViewRate-0,qzbjbl3m:u.thousandLikePercent-0,bzbjbl3m:u.hundredLikePercent-0,fbbj3m:u.noteNumber-0,rcbgzws3m:o.impMedian-0,rcydzws3m:o.readMedian-0,rchdzws3m:o.mEngagementNum-0,rczwdzl3m:o.likeMedian-0,rczwscl3m:o.collectMedian-0,rczwpll3m:o.commentMedian-0,rczwfxl3m:o.shareMedian-0,rchdl3m:o.interactionRate-0,rcspwbl3m:o.videoFullViewRate-0,rctw3mydl3m:o.picture3sViewRate-0,rcqzbjbl3m:o.thousandLikePercent-0,rcbzbjbl3m:o.hundredLikePercent-0,rcfbbj3m:o.noteNumber-0,zrbgzws3m:s.impMedian-0,zrydzws3m:s.readMedian-0,zrhdzws3m:s.mEngagementNum-0,zrzwdzl3m:s.likeMedian-0,zrzwscl3m:s.collectMedian-0,zrzwpll3m:s.commentMedian-0,zrzwfxl3m:s.shareMedian-0,zrhdl3m:s.interactionRate-0,zrspwbl3m:s.videoFullViewRate-0,zrtw3mydl3m:s.picture3sViewRate-0,zrqzbjbl3m:s.thousandLikePercent-0,zrbzbjbl3m:s.hundredLikePercent-0,zrfbbj3m:s.noteNumber-0,zrrcbgzws3m:e.impMedian-0,zrrcydzws3m:e.readMedian-0,zrrchdzws3m:e.mEngagementNum-0,zrrczwdzl3m:e.likeMedian-0,zrrczwscl3m:e.collectMedian-0,zrrczwpll3m:e.commentMedian-0,zrrczwfxl3m:e.shareMedian-0,zrrchdl3m:e.interactionRate-0,zrrcspwbl3m:e.videoFullViewRate-0,zrrctw3mydl3m:e.picture3sViewRate-0,zrrcqzbjbl3m:e.thousandLikePercent-0,zrrcbzbjbl3m:e.hundredLikePercent-0,zrrcfbbj3m:e.noteNumber-0};return Object.assign(t,c),{\u65E5\u5E38\u7B14\u8BB0:{\u53D1\u5E03\u7B14\u8BB0:o.noteNumber,\u5185\u5BB9\u7C7B\u76EE\u53CA\u5360\u6BD4:he(o.noteType),\u5408\u4F5C\u884C\u4E1A:o.tradeNames,\u9605\u8BFB\u91CF\u6765\u6E90:a?{\u53D1\u73B0\u9875:a.readHomefeedPercent,\u641C\u7D22\u9875:a.readSearchPercent,\u5173\u6CE8\u9875:a.readFollowPercent,\u535A\u4E3B\u4E2A\u4EBA\u9875:a.readDetailPercent,\u9644\u8FD1\u9875:a.readNearbyPercent,\u5176\u4ED6:a.readOtherPercent}:"",\u66DD\u5149\u91CF\u6765\u6E90:a?{\u53D1\u73B0\u9875:a.impHomefeedPercent,\u641C\u7D22\u9875:a.impSearchPercent,\u5173\u6CE8\u9875:a.impFollowPercent,\u535A\u4E3B\u4E2A\u4EBA\u9875:a.impDetailPercent,\u9644\u8FD1\u9875:a.impNearbyPercent,\u5176\u4ED6:a.impOtherPercent}:""},\u5408\u4F5C\u7B14\u8BB0:{\u53D1\u5E03\u7B14\u8BB0:u.noteNumber,\u5185\u5BB9\u7C7B\u76EE\u53CA\u5360\u6BD4:he(u.noteType),\u5408\u4F5C\u884C\u4E1A:u.tradeNames,\u9605\u8BFB\u91CF\u6765\u6E90:n?{\u53D1\u73B0\u9875:n.readHomefeedPercent,\u641C\u7D22\u9875:n.readSearchPercent,\u5173\u6CE8\u9875:n.readFollowPercent,\u535A\u4E3B\u4E2A\u4EBA\u9875:n.readDetailPercent,\u9644\u8FD1\u9875:n.readNearbyPercent,\u5176\u4ED6:n.readOtherPercent}:"",\u66DD\u5149\u91CF\u6765\u6E90:n?{\u53D1\u73B0\u9875:n.impHomefeedPercent,\u641C\u7D22\u9875:n.impSearchPercent,\u5173\u6CE8\u9875:n.impFollowPercent,\u535A\u4E3B\u4E2A\u4EBA\u9875:n.impDetailPercent,\u9644\u8FD1\u9875:n.impNearbyPercent,\u5176\u4ED6:n.impOtherPercent}:""}}}function At(o,u,e){const s={fbbj:u.noteNumber-0,ydzws:u.readMedian-0,hdzws:u.mEngagementNum-0,j7thyts:u.activeDayInLast7-0,yy48xshfl:u.responseRate-0,ygyddj_tw:u.pictureReadCost-0,ygyddj_sp:u.videoReadCost-0,rcydzws:o.readMedian-0,rchdzws:o.mEngagementNum-0,rcj7thyts:o.activeDayInLast7-0,rcyy48xshfl:o.responseRate-0,rcygyddj_tw:o.pictureReadCost-0,rcygyddj_sp:o.videoReadCost-0};return Object.assign(e,s),{\u53D1\u5E03\u7B14\u8BB0:o.noteNumber,\u5185\u5BB9\u7C7B\u76EE\u53CA\u5360\u6BD4:he(o.noteType),\u5408\u4F5C\u884C\u4E1A:o.tradeNames,\u65E5\u5E38\u7B14\u8BB0:{\u9605\u8BFB\u4E2D\u4F4D\u6570:o.readMedian,\u4E92\u52A8\u4E2D\u4F4D\u6570:o.interactionMedian,\u8FD17\u5929\u6D3B\u8DC3\u5929\u6570:o.activeDayInLast7,\u9080\u7EA648\u5C0F\u65F6\u56DE\u590D\u7387:o.responseRate,"\u9884\u4F30\u9605\u8BFB\u5355\u4EF7(\u56FE\u6587)":o.pictureReadCost,"\u9884\u4F30\u9605\u8BFB\u5355\u4EF7(\u89C6\u9891)":o.videoReadCost,\u7C89\u4E1D\u91CF\u53D8\u5316\u5E45\u5EA6:o.fans30GrowthRate},\u5408\u4F5C\u7B14\u8BB0:{\u9605\u8BFB\u4E2D\u4F4D\u6570:u.readMedian,\u4E92\u52A8\u4E2D\u4F4D\u6570:u.interactionMedian,\u8FD17\u5929\u6D3B\u8DC3\u5929\u6570:u.activeDayInLast7,\u9080\u7EA648\u5C0F\u65F6\u56DE\u590D\u7387:u.responseRate,"\u9884\u4F30\u9605\u8BFB\u5355\u4EF7(\u56FE\u6587)":u.pictureReadCost,"\u9884\u4F30\u9605\u8BFB\u5355\u4EF7(\u89C6\u9891)":u.videoReadCost,\u7C89\u4E1D\u91CF\u53D8\u5316\u5E45\u5EA6:u.fans30GrowthRate}}}class It extends X{constructor(e,s){s.needInstallCertPem=!0;super(e,s);j(this,"reactive");j(this,"classes");j(this,"checkExists",async(e,s,t=!1)=>{let{user:a}=this.userTabId;if(a){let n={opId:a.id,token:a.token,platform:Q.\u5C0F\u7EA2\u4E66,shop_id:e,product_id:s};if(t){let{shop_name:r,shop_image:l,corp_daren_count:d,shopScore:p,saleQuantity:m,fansNum:h,liveOverview:g,categories:f,wx:E,phone:b,person:_}=this.reactive.shop;n.shop={shop_name:r,shop_image:l,corp_daren_count:d,shopScore:p,saleQuantity:m,fansNum:h,liveOverview:g,categories:f,person:_},E&&!E.includes("**")&&(n.shop.wx=E),b&&!b.includes("**")&&(n.shop.phone=b)}let{code:c,data:i}=await this.api.goodsImport.checkExists(n);if(c==0){let{memberList:r,...l}=i,d={};r.forEach(p=>{d[p.id]=p}),Object.assign(this.reactive,{...l,memberMap:d}),this.reactive.checked=!0}return i}});j(this,"copyRender",e=>{let{$h:s,$Copy:t}=this.context;return s("span",{class:this.classes.hoverPrimary,onClick(){t({text:e,successTip:"\u5DF2\u590D\u5236:"+e})}},e)});this._init()}async _init(){this._css(),await this._prepareUser(),this._view(),this._parse()}_css(){let{$jss:e}=this.context,{classes:s}=Ce(e);this.classes=s}async _parse(){let{$bus:e,$Notice:s}=this.context,t=window.location.search.match(/\?itemId=([^&]*)/);if(t){let a=decodeURIComponent(t[1]);if(t=window.location.search.match(/\&sellerId=([^&]*)/),t){let n=decodeURIComponent(t[1]),[c,i,r,l,d,p,m,h]=await Promise.all([e.subscribe(/detail\/basic/,g=>e.parseBody(g).data),e.subscribe(/detail\/data/,g=>e.parseBody(g).data),e.subscribe(/detail\/images/,g=>e.parseBody(g).data),this.api.ajax.get(`https://pgy.xiaohongshu.com/api/draco/selection-center/seller/detail/basic?seller_id=${n}&pack_scense=6`),this.api.ajax.get(`https://pgy.xiaohongshu.com/api/draco/selection-center/seller/detail/cooperation/intention?seller_id=${n}`),this.api.ajax.get(`https://pgy.xiaohongshu.com/api/draco/selection-center/seller/detail/data?seller_id=${n}`),this.api.ajax.get(`https://pgy.xiaohongshu.com/api/draco/selection-center/user/contact/info?seller_id=${n}`),this.api.ajax.post("https://pgy.xiaohongshu.com/api/draco/selection-center/contact/info/query",{seller_id:n,source:"SELLER_CONTACT_INFO",source_page:"/microapp/selection/product-detail"})]);this.fillProduct(c,i,r),this.fillShop(l.data,d.data,p.data,m,h),this.checkExists(n,a,!0)}else s.error({title:"\u9047\u5230\u95EE\u9898-_-!",desc:"\u672A\u80FD\u89E3\u6790\u5E97\u94FAid"})}}fillProduct(e,s,t){let{planInfo:a,itemInfo:n}=e.result_list[0],{rate:c}=a,{itemShowSkuInfo:i,itemBasicInfo:r}=n,{sku_infos:l}=t,{sale_images:d}=l[0],{itemId:p,itemImage:m,itemImages:h,itemTitle:g}=r,{finalPriceInfo:f}=i,{href:E}=window.location;if(Object.assign(this.reactive.goods,{aim_commission_rate:null,commission_rate:(c/100).toString(),price:Number(f.finalPrice)*100,title:g,product_id:p,cover:m,images:h,details:d.map(b=>b.link),detail_url:E,from_url:E,urgent:0}),s){let{total_cooperation_buyer_count:b,total_sale_count:_,total_view_count:v}=s;this.reactive.goods.day30={buyerCount:b,saleCount:_,viewCount:v}}}fillShop(e,s,t,a,n){let{target_buyer:c}=s||{},{sellerId:i,sellerName:r,image:l,sellerDataInfo:d,sellerScore:p}=e.result_list[0].sellerInfo,{seller_overview_info:m}=t,{seller_connection_info:h}=a.data;if(h){let{tel:f,wechat:E,contact_person:b}=h;Object.assign(this.reactive.shop,{wx:E,phone:f,person:b})}let{contact_info:g}=n.data;if(g){let{tel:f,wechat:E}=g;Object.assign(this.reactive.shop,{wx:E,phone:f})}if(Object.assign(this.reactive.shop,{shop_id:i,shop_name:r,shop_image:l,shopScore:p,liveOverview:m,categories:c?c.content_categorys||[]:[]}),d){let{distributorNum30d:f,fansNum:E,saleQuantity:b}=d;Object.assign(this.reactive.shop,{corp_daren_count:f,fansNum:E,saleQuantity:b})}}_afterLogin(){let{checked:e,shop:s,goods:t}=this.reactive;if(!e){let{shop_id:a}=s,{product_id:n}=t;a&&n&&this.checkExists(a,n,!0)}}_view(){let{context:e,_signOut:s,userTabId:t,classes:a,api:n,checkExists:c,copyRender:i}=this,{$h:r,$reactive:l,$resolveComponent:d,$toRaw:p,$Message:m,$Notice:h}=e,g=l({show:!0,loading:!1,checked:!1,exists:!1,shopList:[],goodsImportList:[],memberMap:{},updatedTime:"",shop:{shop_id:"",shop_name:"",shop_image:"",platform:Q.\u5C0F\u7EA2\u4E66,importOrigin:se.\u63D2\u4EF6,platformOrigin:ae.\u84B2\u516C\u82F1,corp_daren_count:null,shopScore:null,saleQuantity:null,fansNum:null,liveOverview:null,categories:[],wx:"",phone:"",person:""},goods:{aim_commission_rate:null,commission_rate:"",service_rate:"",price:null,title:"",product_id:"",cover:"",images:[],details:[],detail_url:"",from_url:"",product_highlights:"",urgent:0,platform:Q.\u5C0F\u7EA2\u4E66,importOrigin:se.\u63D2\u4EF6,platformOrigin:ae.\u84B2\u516C\u82F1}});this.reactive=g,e.renderFunctionMap.door=function(){return g.show?null:r("img",{src:e.src,class:a.trigger,onClick(){g.show=!0}})},e.renderFunctionMap.drawer=function(){const f=d("Drawer"),E=d("Icon"),b=d("Collapse"),_=d("Panel"),v=d("Image"),D=d("Button"),F=d("Spin"),C=d("Tag"),I=d("Table"),M=d("InputNumber"),O=d("Checkbox"),N=d("Result"),S=d("Numeral");let{shop:k,goods:y,checked:U,shopList:x,goodsImportList:T,memberMap:H}=g,L=x.length;return r(f,{width:500,mask:!1,modelValue:g.show,"onUpdate:modelValue"(A){g.show=A}},{header(){let A=[r("img",{src:e.src,class:a.gaoqu})];return t.user?(A.push(t.user.name+"("+t.user.id+")"),A.push(r("span",{onClick:s},[r(E,{type:"md-exit",size:13}),"\u767B\u51FA"]))):t.tabId&&A.push(r("a",{href:t.href,target:"_blank"},[r(E,{type:"md-contact",size:13}),"\u767B\u5F55"])),A},default(){if(t.user){let A=[r(b,{modelValue:["goodsImport","shop","live"]},[r(_,{name:"goodsImport"},{content(){let P=[r("div",{class:"item"},[r("span",{class:"label"},"\u4EF7\u683C/\u4F63\u91D1\u7387"),r("span",{class:"value"},{default(){return y.price/100+"\uFFE5/"+y.commission_rate+"%"}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u8C08\u5224\u4F63\u91D1\u7387*"),r("span",{class:"value"},[r(M,{max:100,min:0,size:"small",modelValue:y.aim_commission_rate,"onUpdate:modelValue":w=>{y.aim_commission_rate=+w}}),"%",y.aim_commission_rate?"":r("span",{class:a.error},`\u8C08\u5224\u4F63\u91D1\u7387\u5FC5\u586B,\u4E0D\u80FD\u5C0F\u4E8E${y.commission_rate}%`)])]),r("div",{class:"item"},[r("span",{class:"label"},"\u662F\u5426\u52A0\u6025"),r(O,{trueValue:1,falseValue:0,class:"value",size:"small",modelValue:y.urgent,"onUpdate:modelValue":w=>{y.urgent=w}},"\u52A0\u6025")]),r("div",{class:"item"},[r("span",{class:"label"},"ID"),i(y.product_id)]),r("div",{class:"item"},[r("span",{class:"label"},"\u540D\u79F0"),r("span",{class:"value"},{default(){return y.title}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u5C01\u9762"),y.cover?r(v,{src:y.cover,fit:"contain",preview:!0,previewList:y.details,class:a.img}):""]),r("div",{class:"item"},[r("span",{class:"label"},"\u94FE\u63A5"),r("span",{class:"value"},{default(){return y.detail_url}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u6765\u6E90"),r("span",{class:"value"},{default(){return y.from_url}})])];return T.length>0&&P.unshift(r(I,{data:T,size:"small",columns:[{type:"index",width:30},{title:"\u5546\u54C1",className:a.clearPadding,minWidth:130,render(w,{row:B}){return[i(B.product_id),"/",B.title]}},{title:"\u8C08\u5224\u4F63\u91D1\u7387",width:70,align:"center",fixed:"right",render(w,{row:B}){return[(B.commission_rate||0)+"%","/",w("span",{class:a.success},B.aim_commission_rate+"%")]}},{title:"\u8C08\u5224\u72B6\u6001",width:70,className:a.clearPadding,align:"center",render(w,{row:B}){return we(B.status)}},{title:"\u8C08\u5224\u4EBA\u5458",width:80,className:a.clearPadding,align:"center",render(w,{row:B}){let q=H[B.zsOpId];return q?w("div",{class:a.photoFlex},[w("img",{src:ee(q.photo),class:"photo"}),q.name]):""}},{title:"\u5165\u5E93\u65F6\u95F4",width:120,align:"center",render(w,{row:B}){return oe(new Date(B.createdAt))}}]})),r("div",{class:a.flexContainer},P)},default(){return["\u8C08\u5224\u5546\u54C1",r("span",{class:T.length>0?a.info:a.success},T.length>0?`\u5DF2\u5B58\u5728${T.length}\u4E2A\u76F8\u540C\u8C08\u5224\u5546\u54C1`:"")]}}),r(_,{name:"shop"},{content(){let P=[r("div",{class:"item"},[r("span",{class:"label"},"ID"),i(k.shop_id)]),r("div",{class:"item"},[r("span",{class:"label"},"\u540D\u79F0"),r("span",{class:"value"},{default(){return k.shop_name}})]),r("div",{class:"item"},[r("span",{class:"label"},"Logo"),k.shop_image?r(v,{src:k.shop_image,fit:"contain",preview:!0,class:a.img}):""]),r("div",{class:"item"},[r("span",{class:"label"},"\u5185\u5BB9\u7C7B\u76EE"),k.categories.map(w=>r(C,{color:Xe(),size:"small"},w))]),r("div",{class:"item"},[r("span",{class:"label"},"\u8054\u7CFB\u4EBA"),r("span",{class:"value"},{default(){return k.person}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u624B\u673A\u53F7"),r("span",{class:"value"},{default(){return k.phone}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u5FAE\u4FE1"),r("span",{class:"value"},{default(){return k.wx}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u6708\u5408\u4F5C\u8FBE\u4EBA\u6570"),r("span",{class:"value"},{default(){return k.corp_daren_count}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u7C89\u4E1D\u6570"),r(S,{value:k.fansNum,format:"0,0"})]),r("div",{class:"item"},[r("span",{class:"label"},"\u5DF2\u552E"),r(S,{value:k.saleQuantity,format:"0,0"})]),r("div",{class:"item"},[r("span",{class:"label"},"\u8BC4\u5206"),r("span",{class:"value"},{default(){if(k.shopScore){let{sellerScore:w,itemScore:B,replyRateScore:q,deliveryScore:Ee}=k.shopScore;return`\u5E97\u94FA:${w||"..."}, \u5546\u54C1:${B||"..."}, \u54A8\u8BE2:${q||"..."}, \u7269\u6D41:${Ee||"..."}`}return""}})])];return U&&L>0&&P.unshift(r(I,{data:x,size:"small",columns:[{type:"index",width:30},{title:"\u5E97\u94FA",minWidth:130,className:a.clearPadding,render(w,{row:B}){return[i(B.shop_id),"/",B.shop_name]}},{title:"\u8D23\u4EFB\u5546\u52A1",width:100,align:"center",className:a.clearPadding,render(w,{row:B}){let q=H[B.zsOpId];return q?r("div",{class:a.photoFlex},[r("img",{src:ee(q.photo),class:"photo"}),q.name]):""}},{title:"\u5165\u5E93\u65F6\u95F4",width:120,className:a.clearPadding,align:"center",render(w,{row:B}){return oe(new Date(B.createdAt))}}]})),r("div",{class:a.flexContainer},P)},default(){return["\u5E97\u94FA",r("span",{class:L>0?a.info:a.success},L>0?`\u5DF2\u5B58\u5728${L}\u4E2A\u76F8\u540C\u5E97\u94FA`:"\u53EF\u5165\u5E93")]}}),r(_,{name:"live"},{content(){let P=[];if(k.liveOverview){let{live_cps_goods_cnt:w,live_cps_goods_sell_cnt:B,live_cps_per_price:q,live_cps_relation_cnt:Ee,max_age_portrait:Ve,max_age_portrait_rate:Ne,max_customer_portrait:He,max_customer_portrait_rate:Re,max_gender_portrait:Ue,max_gender_portrait_rate:Ge}=k.liveOverview;P.push(r("div",{class:"item"},[r("span",{class:"label"},"\u76F4\u64AD\u9500\u91CF"),r(S,{value:B,format:"0,0"})]),r("div",{class:"item"},[r("span",{class:"label"},"\u76F4\u64AD\u5BA2\u5355\u4EF7"),r(S,{value:q,format:"0,0.00"})]),r("div",{class:"item"},[r("span",{class:"label"},"\u76F4\u64AD\u5546\u54C1\u6570"),r(S,{value:w,format:"0,0"})]),r("div",{class:"item"},[r("span",{class:"label"},"\u7528\u6237\u4E0B\u5355\u4EBA\u7FA4"),r("span",{class:"value"},{default(){return(Number(Re)*100).toFixed(2)+"%"+He}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u5E74\u9F84"),r("span",{class:"value"},{default(){return(Number(Ne)*100).toFixed(2)+"%"+Ve}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u6027\u522B"),r("span",{class:"value"},{default(){return(Number(Ge)*100).toFixed(2)+"%"+(Ue=="1"?"\u5973":"\u7537")}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u5173\u8054\u76F4\u64AD\u6570"),r("span",{class:"value"},{default(){return Ee}})]))}return r("div",{class:a.flexContainer},P)},default(){return"30\u5929\u5546\u5BB6\u6570\u636E"}})]),r("div",{class:a.buttonContainer},r(D,{disabled:!U,long:!0,loading:g.loading,type:"primary",async onClick(){if(y.aim_commission_rate)if(y.commission_rate&&y.aim_commission_rate<parseInt(y.commission_rate))h.error({desc:"\u8C08\u5224\u4F63\u91D1\u7387\u4E0D\u80FD\u4F4E\u4E8E"+y.commission_rate+"%"});else{let P=p(g.shop);P.wx&&P.wx.includes("**")&&delete P.wx,P.phone&&P.phone.includes("**")&&delete P.phone,g.loading=!0;let w={opId:t.user.id,token:t.user.token,shop:P,goods:p(y)},{code:B,data:q}=await n.goodsImport.import(w);B==0&&(q>0?h.error({title:"\u65E0\u9700\u521B\u5EFA\u8C08\u5224\u5546\u54C1",desc:"\u5DF2\u5B58\u5728\u76F8\u540C\u7684\u4F63\u91D1\u7387"}):m.success("\u6210\u529F\u521B\u5EFA\u5546\u54C1\u8C08\u5224")),g.loading=!1,c(P.shop_id,y.product_id)}else h.error({desc:"\u8BF7\u5148\u586B\u5199\u8C08\u5224\u4F63\u91D1\u7387"})}},(L<1?"\u5165\u5E93":"\u66F4\u65B0")+"\u5E97\u94FA\u5E76\u521B\u5EFA\u5546\u54C1\u8C08\u5224"+(y.aim_commission_rate?y.aim_commission_rate+"%":"")))];return U||A.push(r(F,{fix:!0})),A}else return r(N,{type:"warning",title:"\u8BF7\u5148\u767B\u5F55",class:a.marginTop},{actions(){return r(D,{type:"success",onClick(){window.open(t.href,"_blank")}},"\u9A6C\u4E0A\u767B\u5F55")}})}})}}}class kt extends me{constructor(u,e){super(u,e)}_getElClass(){return".top-info .link-index"}async _parser(){return this.collectMainData()}_formMeta(u){let{options:e,reactive:s}=this;s.title=`\u8D44\u6E90\u57FA\u672C\u4FE1\u606F(${e.version})`;const t=te(u.price,this.render),a=te(u.dataOverview,this.render),n=te(u.capability,this.render),c=te(u.rank,this.render);return[this._basicView(u),{align:"middle",gutter:0,subList:[{span:4,html:this.render.label("\u4ECB\u7ECD")},{span:20,html:u.introduce?this.render.site(u.introduce):""},{span:4,html:this.render.label("\u80FD\u529B")},{span:20,html:u.capability?Object.values(u.capability).join(","):""},{span:4,html:this.render.label("\u7B49\u7EA7")},{span:8,html:u.level},{span:4,html:this.render.label("\u4E00\u7EA7\u5185\u5BB9\u6807\u7B7E")},{span:8,html:u.contentTags.join(",")},{span:4,html:this.render.label("\u4E8C\u7EA7\u5185\u5BB9\u6807\u7B7E")},{span:8,html:u.subContentTags.join(",")},{span:4,html:this.render.label("\u4E00\u7EA7\u884C\u4E1A\u6807\u7B7E")},{span:8,html:u.fieldTags.join(",")},{span:4,html:this.render.label("\u4E8C\u7EA7\u884C\u4E1A\u6807\u7B7E")},{span:8,html:u.subFieldTags.join(",")},{span:4,html:this.render.label("\u6027\u522B")},{span:8,html:u.sex},{span:24,html:this.render.title("\u6570\u636E")},...n,...a,...c,{span:24,html:this.render.title("\u4EF7\u683C")},...t]}]}_makeParams(u){const{rank:e,price:s,capability:t,dataOverview:a,...n}=u;return{...n,rank:JSON.stringify(e),price:JSON.stringify(s),capability:JSON.stringify(t),dataOverview:JSON.stringify(a)}}_validateSubmit(u){return!0}async _ending(u){const{tag:e,gaoqId:s,fromTabId:t,forGaoqu:a,fromId:n}=this.options;if(t&&s&&t>0&&a==J.\u722C\u53D6\u661F\u56FE\u7B49\u7EA7){let c="\u535A\u4E3B\u4E0D\u5B58\u5728\u6216\u7F51\u7EDC\u9519\u8BEF";return u.mediaId&&(c=u.level),R(G({id:s,res:c,toTabId:t,toId:n,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u8865\u4E01,closeTab:!0},e))}else{if(t&&t>0&&a==J.\u56DE\u586B\u57FA\u7840\u6570\u636E&&n)return R(G({data:u,toTabId:t,toId:n,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u63D0\u53D6,closeTab:!0},e));if(t&&t>0&&a==J.\u4E3B\u9875\u81EA\u52A8\u5165\u5E93){console.log("this",this);let{id:c,token:i}=this.userTabId.user;u.opId=c,console.log("token",i);let r={},l=null;try{r=await this.api.extension.import(u,i)}catch(d){l=d}return R(G({id:s,res:{form:u,data:r.data,error:l},toTabId:t,toId:n,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u5165\u5E93,closeTab:!0},e))}}}_validateAuto(u){return!u.mediaId||!u.version?(this.context.$Notice.error({title:"\u9047\u5230\u95EE\u9898-_-!",desc:"\u6570\u636E\u4E0D\u5B8C\u5907"}),!1):!0}async collectMainData(){let u={};const{clean:e,xtId:s,platformSite:t}=this.locationData();if(document.querySelector(".author-base-info .other-author-pages")==null){const{mcn:n,uid:c,sex:i,site:r,name:l,level:d,photo:p,secUid:m,region:h,shortId:g,mediaId:f,fanCount:E,introduce:b,price_info:_,industry_tags:v,tags_relation:D,hot_list_ranks:F}=await this.baseBusData(),C=await this.busData(),I=await this.busGetContact();u={platform:"\u6296\u97F3",origin:"\u661F\u56FE",photo:p,site:r,platformSite:t,name:l,fanCount:E,sex:i,region:h,mcn:n,introduce:b,version:this.options.version,uid:c,shortId:g,secUid:m,clean:e,mediaId:f,level:d,xtId:s};const{monthTouchCount:M,monthConnectCount:O}=this.dom2Data(),{rank:N,price:S,fieldTags:k,contentTags:y,subFieldTags:U,dataOverview:x,subContentTags:T,cepAndCpmMap:H,authorContent:L}=this.dataHandle(_,D,v,M,O,C,F);u.rank=N,u.price=S,u.fieldTags=k,u.contentTags=y,u.patch=I,u.dataOverview={...x,...I},u.subContentTags=T,u.subFieldTags=U,u.capability={...H,...L}}return u}locationData(){const u="\u6296\u97F3id\u4FEE\u6B63",s=location.href.match(/\/douyin\/(\d+)/)[1];let{origin:t,pathname:a}=window.location,n=t+a;const c={xtId:s,clean:u,platformSite:n};return console.log("locationData ok",c),c}async baseBusData(){const u=this.context.$bus,e=u.subscribe(/\/api\/author\/get_author_base_info/,L=>{let A=u.parseBody(L);return A.hasOwnProperty("nick_name")?A:!1}),s=u.subscribe(/\/api\/author\/get_author_marketing_info/,L=>{let A=u.parseBody(L);return A.hasOwnProperty("hot_list_ranks")?A:!1}),t=u.subscribe(/\/api\/author\/get_author_platform_channel_info_v2/,L=>{let A=u.parseBody(L);return A.hasOwnProperty("self_intro")?A:!1}),[a,n,c]=await Promise.all([e,s,t]),{grade:i,mcn_name:r,id:l,gender:d,nick_name:p,province:m,city:h,sec_uid:g,short_id:f,unique_id:E,tags_relation:b,avatar_uri:_,follower:v}=a;console.log("basePort ok",{baseInfoBody:a,marketInfoBody:n,introduceBody:c});const D=E,F=p,C=f,I=g,M=r,O=_,N=d==1?"\u7537":"\u5973",S="https://www.douyin.com/user/"+I;let k=m+" "+h;k=k&&k.trim();let y="LV"+i;const{price_info:U,industry_tags:x,hot_list_ranks:T}=n,H={mcn:M,uid:I,sex:N,site:S,name:F,level:y,photo:O,secUid:I,region:k,shortId:C,mediaId:D,price_info:U,tags_relation:b,industry_tags:x,hot_list_ranks:T,fanCount:v,introduce:c.self_intro};return console.log("baseBusData ok",H),H}async busData(){const u=this.context.$bus;let e={};const s=await ue(1500,()=>{const t=document.querySelector('.page-right .card-panel .is-top[role="tablist"]');if(t){const a=t.children;if(a&&a[2])return a}return!1});if(s&&s[2]){console.log("tabList[2]",1),s[2].click();const t=u.subscribe(/\/api\/data_sp\/get_author_spread_info/,r=>{console.log("get_author_spread_info",r);let l=u.parseBody(r);return l.hasOwnProperty("expect_cpe")?l:!1}),a=u.subscribe(/\/api\/data_sp\/author_video_distribution/,r=>{let l=u.parseBody(r);return l.hasOwnProperty("video_content_distribution")?l:!1}),[n,c]=await Promise.all([t,a]),{video_content_distribution:i}=c;s[1].click(),e={authorContent1m:n,video_content_distribution:i}}return console.log("busData ok",e),e}async busGetContact(){const{$bus:u,$Message:e}=this.context;return new Promise(async(s,t)=>{const a={};setTimeout(()=>{s(a)},2e3);let n={};try{n=u.subscribe(/\/api\/gauthor\/author_get_business_card_info/,i=>{console.log("author_get_business_card_info",i);let r=u.parseBody(i);return r.hasOwnProperty("base_resp")?r:!1})}catch(i){e.error({content:"\u661F\u56FE\u65B0\u589E\u6293\u53D6\u6570\u636E\uFF0C\u9700\u91CD\u65B0\u5B89\u88C5\u63D2\u4EF6"}),console.log("contactPromise",n,i)}const[c]=await Promise.all([n]);if(console.log("contact",c),c){const{card_info:i}=c;if(i){const{wechat:r,email:l}=i;a.wxId=r,l&&(a.email=l)}}console.log("contact",a),s(a)})}dom2Data(){let u=re(".author-page-info .link-index").split(`
`);const e=K(u[1]),t={monthTouchCount:K(u[3]),monthConnectCount:e};return console.log("dom2Data ok",t),t}dataHandle(u,e,s,t,a,n,c){const{authorContent1m:i,video_content_distribution:r}=n;console.log("authorContent1m",i);const l=this.getAuthorContent({authorContent1m:i});let d={};if(u&&u.length>0){const D={};u.forEach(F=>{F.price&&(D[F.desc]=F.price)}),d=D}let p={};r&&(p=this.contentTypeHandle(r));let m={};i&&(m=this.getCpeAndCpm(i));let h=[],g=[],f=[],E=Object.keys(e);E&&E.forEach(D=>{h=[...h,...e[D]]}),s&&s.forEach(D=>{const F=D.split("-");g.push(F[1]),f.includes(F[0])||f.push(F[0])});const b={\u5185\u5BB9\u7C7B\u578B\u5206\u6790:p,\u6570\u636E\u6982\u89C8:{\u6708\u8FDE\u63A5\u7528\u6237\u6570:a,\u6708\u6DF1\u5EA6\u7528\u6237\u6570:t}},_={};c&&c.forEach((D,F)=>{const{hot_list_name:C,industry_name:I,rank_level:M,period:O}=D,N={\u7C7B\u522B\u699C:C,\u884C\u4E1A:I,\u65F6\u95F4\u699C:O,\u540D\u6B21:M},S="rank"+F;_[S]=N}),console.log("cepAndCpmMap",m);const v={rank:_,price:d,fieldTags:f,contentTags:E,subFieldTags:g,dataOverview:b,cepAndCpmMap:m,subContentTags:h,authorContent:l};return console.log("dataHandle ok",v),v}getAuthorContent(u){const e={},s={authorContent1m:{prefix:"gr",suffix:"1m"},authorContent3m:{prefix:"gr",suffix:"3m"},authorContentXtAll1m:{prefix:"xtAll",suffix:"1m"},authorContentXtAll3m:{prefix:"xtAll",suffix:"3m"}};return Object.keys(u).forEach(t=>{if(s[t]){const{prefix:a,suffix:n}=s[t],c=u[t];if(c){const{play_over_rate:i,interact_rate:r,item_rate:l}=u[t];if(e[a+"wblOvertake"+n]=z(i,"overtake"),e[a+"wblValue"+n]=z(i,"value"),e[a+"hdlOvertake"+n]=z(r,"overtake"),e[a+"hdlValue"+n]=z(r,"value"),l){const{play_mid:d,item_num:p}=l;e[a+"bflzwsOvertake"+n]=z(d,"overtake"),e[a+"bflzwsValue"+n]=z(d,"value")}e[a+"fbzp"+n]=z(c,"item_num"),e[a+"pjsc"+n]=z(c,"avg_duration"),e[a+"pjdz"+n]=z(c,"like_avg"),e[a+"pjpl"+n]=z(c,"comment_avg"),e[a+"pjzf"+n]=z(c,"share_avg")}}}),e}getAuthorContentData(u,e,s=1){if(u){const t=u[e];if(t)return Math.ceil(typeof t=="number"?t*s:Number(t)*s);if(t===0)return t}return null}contentTypeHandle(u){const e={};return u.forEach(s=>{const{name:t,proportion:a}=s;e[t]=a}),e}getCpeAndCpm(u){let e={};if(u){const{expect_cpe:s,expect_cpm:t}=u;s&&(e={cpe120:z(s,"cpe_1_20"),cpe2160:z(s,"cpe_21_60"),cpe60:z(s,"cpe_60")}),t&&(e.cpm120=z(t,"cpm_1_20"),e.cpm2160=z(t,"cpm_21_60"),e.cpm60=z(t,"cpm_60"))}return e}}function Pt(o,u){return console.log("options.forGaoqu",u.forGaoqu),u.forGaoqu==J.\u67E5\u8BE2\u661F\u56FE\u5B58\u5728\u8D44\u6E90?new St(o,u):u.forGaoqu==J.\u68C0\u6D4B\u662F\u5426\u767B\u5F55?new Tt(o,u):new zt(o,u)}class Tt extends X{constructor(u,e){super(u,e),this._init()}async _init(){let u=!1,e=await this._checkEnv(),s="\u661F\u56FE\u73AF\u5883\u68C0\u6D4B\u6B63\u5E38";if(e?u=await this.doSomething():s="\u63D2\u4EF6\u672A\u767B\u5F55",e&&u){const{fromTabId:t,tag:a}=this.options;return R(G({tag:a,content:s,pass:u,toTabId:t,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u73AF\u5883\u68C0\u6D4B,closeTab:!0},"\u661F\u56FE\u63D2\u4EF6\u73AF\u5883\u68C0\u6D4B"))}}async doSomething(){let u=!1;const{context:e}=this;let{authors:s}=await e.$bus.subscribe(/api\/gsearch\/search_for_author_square/,t=>e.$bus.parseBody(t));return s&&s.length>0&&(u=!0),u}}class St extends X{constructor(u,e){super(u,e),this.doSomething()}doSomething(){const{keyword:u,fromTabId:e,fromId:s,gaoqId:t,name:a}=this.options,{$bus:n}=this.context;if(u&&a){let c=setInterval(async()=>{console.log("subscribeList",JSON.parse(JSON.stringify(n.getSubscribeList())));let i=document.querySelector(".search-input-new .search-input-inner input");if(i){clearInterval(c),i.value=u;var r=new InputEvent("input",{bubbles:!0});i.dispatchEvent(r),document.querySelector(".market-search-top-bar").click(),await ue(800,()=>{});let{authors:d}=await n.subscribe(/api\/gsearch\/search_for_author_square/,h=>n.parseBody(h)),p={jump:!1,xtId:""},m=d?d[0]:!1;if(m){const h=m.attribute_datas.nick_name;console.log("nick_name.includes(name)||name.includes(nick_name)",h.includes(a)||a.includes(h)),h.includes(a)||a.includes(h)?p.xtId=m.star_id:p.jump=!0}return console.log("hit",s,p,m,a,d),R(G({id:t,data:p,toTabId:e,toId:s,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u63D0\u53D6,closeTab:!0},"\u67E5\u8BE2\u661F\u56FE\u5B58\u5728\u8D44\u6E90"))}},500)}}}class zt extends ye{constructor(u,e){super(u,e)}_otherCss(){return{".author-info-list":{width:"500px"}}}async _collectTag(){const{$bus:u}=this.context,e=await this.busTagData(u),s=this.dataHandle(e),t=ie(s,"contentTags"),a=ie(s,"fieldTags");console.log("tag",s),a&&t&&await this.api.extension.xtTag(s)}_updatePage(){const{$bus:u}=this.context,e=/\/api\/gsearch\/search_for_author_square/,s=a=>u.parseBody(a),t=a=>{this.listExtension(a)};u.watch(e,s,t)}_autoPatchNext(){const{context:u,reactive:e}=this,{autoImportList:s,needImportProject:t}=e,a=e.autoImportList.find(n=>n.imported==null);if(a){let n=`${Ke.\u661F\u56FE}${a.xtId}?forGaoqu=${J.\u4E3B\u9875\u81EA\u52A8\u5165\u5E93}&fromTabId=${this.userTabId.tabId}`;window.open(n)}else t&&this._importResourceToProject()}_updateResourceList(u,e){const{xtId:s}=u,{content:t}=e,{context:a,reactive:n}=this,{autoImportList:c,resourceList:i}=n,l=t.match(/(\d+)/)[1],d=c.find(m=>m.xtId==s),{index:p}=d;d.imported=!0,i[p].extensionImportId=l,i[p].exist=`\u5F85\u5EFA\u8054 / ${l}`,i[p].class="op-doing",this._autoPatchNext()}async listExtension(u){console.log("\u83B7\u53D6\u5230list body",u);let{authors:e}=u;const s=[],t={};e.forEach(p=>{const{nick_name:m,id:h,avatar_uri:g}=p.attribute_datas,E=g.match(/aweme-avatar\/(\S+)\./)[1];s.push(h),t[E]={name:m,id:h}});const a={platformId:ke.\u6296\u97F3,key:"xtId",codeList:s,fields:"name, mediaId, xtId, publication, mcn, qyGgCode, qyWxCode, qyBdCode, directWise, rebate",extensionFields:"name, mediaId, xtId, mcn"},{code:n,data:c}=await this.api.resource.existList(a),{resourceList:i,extensionImportList:r}=c,l={},d={};i.forEach(p=>{const{name:m,xtId:h}=p;l[h]=p}),r.forEach(p=>{p.id==1&&this.api.baojing({tag:this.options.tag,message:JSON.stringify(p),site:window.location.href}),d[p.xtId]=p}),Object.keys(t).forEach(p=>{const{name:m,id:h}=t[p];if(t[p].checked=!1,l.hasOwnProperty(h)){const{publication:g,mcn:f,qyGgCode:E,qyWxCode:b,qyBdCode:_,directWise:v,rebate:D}=l[h];let F=E,C="\u5E7F\u544A";F||(F=b,C="\u7535\u5546"),F||(F=_,C="\u672C\u5730\u751F\u6D3B"),t[p].exist=`\u5DF2\u5EFA\u8054 / ${l[h].id}`,t[p].publication=g,t[p].mcn=f,t[p].resourceId=l[h].id,t[p].qrCode=F&&ee(F),t[p].qrCodeType=F&&C,t[p].directWise=v,t[p].rebate=D}else d[h]?(t[p].exist=`\u5F85\u5EFA\u8054 / ${d[h].id}`,t[p].extensionImportId=d[h].id):t[p].exist="\u672A\u5EFA\u8054"}),this.reactive.avatarMap=t,console.log("avatarMap",t),await this.insertDom(t,l,d)}async insertDom(u,e,s){const t=await ue(2e3,()=>document.querySelector(".author-table .author-info-list-wrapper .author-info-list"));this.reactive.insertHeader={to:".table-header .author-header",name:"op\u4FE1\u606F",checked:!1};const a=await ue(2e3,()=>t.querySelectorAll(".lazy-load")),n=[];console.log("xtInfoDom",a),console.log("xtInfoDom",a.length);for(let c=0;c<a.length;c++){const i=await ue(6e3,()=>(console.log("xtInfoDom[i].children",a[c].children),a[c].children));console.log("infoDomLst",i.length);for(let r=0;r<i.length;r++){const l=i[r];let d=l.querySelector(".user-avatar-image");d||(d=await ue(8e3,()=>{const b=document.querySelector(".author-table .author-info-list-wrapper .author-info-list .lazy-load").children[c].children[r].querySelector(".user-avatar-image");return console.log("img",b),b}));const p=d.getAttribute("src"),m=Object.keys(u).find(E=>p.includes(E)),{id:h}=u[m],g=l.getAttribute("data-xtId");(!g||g&&(e.hasOwnProperty(g)||s.hasOwnProperty(g)))&&(e[h]&&(u[m].class="op-done"),s[h]&&(u[m].class="op-doing")),l.setAttribute("data-xtId",h),l.style.position="relative";const f={qs:`.author-info[data-xtid="${h}"]`,...u[m]};n.push(f)}}this.reactive.resourceList=n,console.log("this.context",this.context),console.log("this.reactive",this.reactive)}async busTagData(u){const e=await u.subscribe(/\/api\/user\/author_options/,s=>{let t=u.parseBody(s);return console.log("body",t),t==null?void 0:t.data});return console.log("busTagData ok ",e),e}dataHandle({content_tag_v2:u,industry_tag_v2:e}){const t=this.deconstructionTransformation(u).tagList;let{tagList:a,tagMap:n}=this.deconstructionTransformation(e);const c={contentTags:t,fieldTags:a,fieldMap:n};return console.log("dataHandle ok",c),c}deconstructionTransformation(u){const e=[],s={};return u.forEach(t=>{const{first:a,second:n}=t,c=Object.values(a)[0];Object.assign(s,a);const i=[];n.forEach(r=>{i.push(...Object.values(r))}),e.push({tag:c,tags:i})}),{tagList:e,tagMap:s}}}class Ot extends me{constructor(u,e){super(u,e)}async _parser(){let u="";const{platformSite:e,byCode:s}=this.locationData(),{sex:t,site:a,mediaId:n,level:c,mainCategory:i,fanCount:r,region:l,mcn:d,photo:p,name:m,contentTags:h,introduce:g,demand:f}=await this.baseBusData();a&&(u=a.match(/https:\/\/www.douyin.com\/user\/(\S+)/)[1]);const E=await this.cargoAnalysisBusData(),b=await this.authorFanData(E),_=await this.capabilityPatchData(),{patch:v,capabilityPatchSecond:D}=await this.domData();let F={origin:"\u767E\u5E94",platform:"\u6296\u97F3",name:m,byCode:s,fanCount:r,contentTags:h,region:l,patch:v,dataOverview:b,mainCategory:i,mcn:d,introduce:g,demand:f,photo:p,site:a,mediaId:n,version:this.options.version,capability:{..._,...E,...D},sex:t,platformSite:e,level:c,uid:u};return console.log("json",F),F}_formMeta(u){let{options:e,reactive:s}=this;s.title=`\u8D44\u6E90\u57FA\u672C\u4FE1\u606F(${e.version})`;const t=te(u.mainCategory,this.render),a=te(u.demand,this.render),n=this.jsonToArr(u.saleAnalysis,this.render);return[this._basicView(u),{align:"middle",gutter:0,subList:[{span:4,html:this.render.label("\u4ECB\u7ECD")},{span:20,html:u.introduce},{span:4,html:this.render.label("\u6027\u522B")},{span:8,html:u.sex},{span:4,html:this.render.label("\u7C89\u4E1D")},{span:8,html:u.fanCount},{span:4,html:this.render.label("\u7B49\u7EA7")},{span:8,html:u.level},{span:4,html:this.render.label("\u673A\u6784")},{span:8,html:u.mcn},{span:24,html:""},{span:4,html:this.render.label("\u5185\u5BB9\u6807\u7B7E")},{span:20,html:u.contentTags.join(",")||""},...a,...t,{span:24,html:this.render.title("\u5E26\u8D27\u5206\u6790")},...n]}]}_ending(u){const{tag:e,gaoqId:s,fromTabId:t,forGaoqu:a,fromId:n}=this.options;if(t&&s&&t>0&&a==J.\u722C\u53D6\u767E\u5E94\u7B49\u7EA7){let c="\u535A\u4E3B\u4E0D\u5B58\u5728\u6216\u7F51\u7EDC\u9519\u8BEF";return u.mediaId&&(c=u.level),R(G({id:s,res:c,toTabId:t,toId:n,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u8865\u4E01,closeTab:!0},e))}else if(t&&t>0&&a==J.\u56DE\u586B\u57FA\u7840\u6570\u636E&&n)return R(G({data:u,toTabId:t,toId:n,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u63D0\u53D6,closeTab:!0},e))}_makeParams(u){const{saleAnalysis:e,demand:s,capability:t,mainCategory:a,dataOverview:n,...c}=u;return{...c,capability:JSON.stringify(t),saleAnalysis:JSON.stringify(e),demand:JSON.stringify(s),mainCategory:JSON.stringify(a),dataOverview:JSON.stringify(n)}}_validateSubmit(u){return!0}_validateAuto(u){const{byCode:e}=u;return e?!0:(this.context.$Notice.error({title:"\u83B7\u53D6byCode\u5931\u8D25"}),!1)}locationData(){const e=window.location.href.match(/uid=(\w+)&?/);console.log(e);const s=e[1];console.log("byCode",s);const t="https://buyin.jinritemai.com/dashboard/servicehall/daren-profile?uid="+s;return console.log("locationData ok",{platformSite:t}),{platformSite:t,byCode:s}}async baseBusData(){const{$bus:u}=this.context;let e=await u.subscribe(/\/homePage\/author\/profile/,t=>{let a=u.parseBody(t);return console.log("profile-from",t.from,t.url),a.data.hasOwnProperty("account_douyin")?a.data:!1});if(sessionStorage.getItem("uid")&&sessionStorage.removeItem("uid"),e){const{gender:t,web_homepage_url:a,account_douyin:n,level:c,sale_type:i,fans_sum:r,city:l,agency:d,avatar:p,nickname:m,works_type:h,introduction:g,product_main_type_array:f,intention_catgory:E}=e;console.log("authorProfileBody",e);let b={};f&&f.map(v=>{let{name:D,val:F}=v;b[D]=F+"%"});const _={sex:t==1?"\u7537":"\u5973",site:a,mediaId:n,level:c&&"LV"+c,dataOverview:i,fanCount:K(r),region:l,mcn:d,photo:p,name:m,contentTags:h,introduce:g,mainCategory:b,demand:E};return console.log("baseBusData ok",_),_}return console.log("baseBusData failed"),{}}async cargoAnalysisBusData(){const{$bus:u}=this.context;let e={},s={};try{const t=await u.subscribe(/\/api\/authorStatData\/authorOverviewV2/,p=>{let m=u.parseBody(p);return m.data?m.data:!1}),{live_data:a,video_data:n,key_data:c,sale_analysis:i}=t;e={xszeMin:c.sale_low,xszeMax:c.sale_high,tgsps:c.promotion_sum,lsdhts:c.total_work_day,hzdps:c.cooperate_shop_num,zbxszb:a.percentage,zbcc:a.count,zbgkrs:a.watching_num,cjxseMin:a.sale_low,cjxseMax:a.sale_high,zbgpmMin:a.GPM_low,zbgpmMax:a.GPM_high,zbzcl:K(a.recommend_rate),spxszb:n.percentage,dhsps:n.count,dhspbfl:n.watching_num,dspxseMin:n.sale_low,dspxseMax:n.sale_high,spgpmMin:n.GPM_low,spgpmMax:n.GPM_high,spzcl:K(n.recommend_rate)};const r=i.all.catogory,l=i.all.brand;for(let p=0;p<l.length;p++)e["ppppt"+(p+1)]=l[p].brand,e["ppjjt"+(p+1)]=l[p].average_price,e["ppxsemint"+(p+1)]=l[p].average_GMV_low,e["ppxsemaxt"+(p+1)]=l[p].average_GMV_high;for(let p=0;p<r.length;p++)e["lmlmt"+(p+1)]=r[p].category,e["lmjjt"+(p+1)]=r[p].average_price,e["lmxsemint"+(p+1)]=r[p].average_GMV_low,e["lmxsemaxt"+(p+1)]=r[p].average_GMV_high,e["lmyjmint"+(p+1)]=r[p].suggest_ratio_min,e["lmyjmaxt"+(p+1)]=r[p].suggest_ratio_max;const d=e;return console.log("cargoAnalysisBusData ok",e,1111),d}catch(t){return console.log("error",t),this.api.baojing({tag:this.options.tag,error:t.message,at:"cargoAnalysisBusData",url:window.location.href}),{capability:e,saleAnalysis:s}}}async authorFanData(u){const{$bus:e}=this.context;let s={},t="";const a=await ue(800,()=>Z(".auxo-tabs-nav-list"));if(console.log("dom",a),a){const n=a.children;if(console.log("children",n),n.length==7)try{n[3].click();const c=await e.subscribe(/\/authorStatData\/authorFansV2/,E=>{let b=e.parseBody(E);return console.log("body.data.hasOwnProperty('age')",b.data.hasOwnProperty("age"),b),b.data.hasOwnProperty("age")?b.data:!1});let{age:i,analysis:r,avg_pay_price:l,city_level:d,consumer_group:p,device:m,gender:h,gmv_main_cate:g}=c;s={age:i,avg_pay_price:l,city_level:d,device:m,consumer_group:p,gender:h,gmv_main_cate:g};const f=r[0].value;if(console.log("analysis",r),console.log("analysis[0].value",r[0].value),f){let E=f[0].match(/(\S+) \((\d+)/);E[1]=="\u5973\u6027"?(u.fsFemaleRate=E[2],u.fsMaleRate=100-E[2]):(u.fsFemaleRate=100-E[2],u.fsMaleRate=E[2]),E=f[1].match(/(\S+) \((\d+)/),u.fsnlfbMax=E[1],u.fsnlfbRate=E[2],E=f[2].match(/(\S+) \((\d+)/),u.fscsdjfbMax=E[1],u.fscsdjfbRate=E[2],E=f[3].match(/(\S+) \((\d+)/),u.fsbdrqfbMax=E[1],u.fsbdrqfbRate=E[2],u.fsKey=f.join(),console.log("capability",u)}}catch(c){console.log("sellProductResponse",c),this.api.baojing({tag:this.options.tag,error:c.message,at:"doCollect",url:window.location.href})}else this.api.baojing({tag:this.options.tag,error:"\u535A\u4E3Btabs\u5217\u8F83\u5C11\uFF0C\u8BF7\u505A\u517C\u5BB9\u5904\u7406",at:"doCollect",url:window.location.href})}return console.log("authorFanData",s,t),s}async capabilityPatchData(){const{$bus:u}=this.context;let e={};const s=await ue(800,()=>Z(".auxo-tabs-nav-list"));if(s){const t=s.children;if(console.log("children",t),t.length==7)try{t[4].click();const a=await u.subscribe(/\/authorStatData\/salesAnalyseV2/,r=>{let l=u.parseBody(r);return l.data.hasOwnProperty("video_data")?l.data:!1}),{live_data:n,video_data:c,key_data:i}=a;e={pjjdj:i.average_price,zbtgsps:n.promotion_sum,zbhzdps:n.cooperate_shop_num,zbpjjdj:n.average_price,sptgsps:c.promotion_sum,sphzdps:c.cooperate_shop_num,sppjjdj:c.average_price},t[0].click()}catch(a){console.log("sellProductResponse",a),this.api.baojing({tag:this.options.tag,error:a.message,at:"doCollect",url:window.location.href})}else this.api.baojing({tag:this.options.tag,error:"\u535A\u4E3Btabs\u5217\u8F83\u5C11\uFF0C\u8BF7\u505A\u517C\u5BB9\u5904\u7406",at:"doCollect",url:window.location.href})}return console.log("capability",e),e}async domData(){let u=this.dataOverviewInfo(".daren-overview-base-basepoints");const s={patch:await this.phoneWxHandler(),capabilityPatchSecond:u};return console.log("domData ok",s),s}dataOverviewInfo(u){let e=re(u),s={},t=[];return e.length>4&&(t=e.split(`
`),t=t.filter(a=>!/[]/.test(a)),s={dhkb:Math.ceil(t[0]*100),xyf:Math.ceil(t[2]*100),lyf:Math.ceil(t[4]*100),pjf:Math.ceil(t[6]*100)}),s}async phoneWxHandler(){let u=Z(".daren-overview-base-contactinfo");if(u){const e=u.textContent;let s=e.match(/(\w+)/),t=e.match(/(\w+)/);const a={};return s&&!s[1].includes("*****")&&(a.phone=s[1]),t&&!t[1].includes("*****")&&(a.wxId=t[1]),console.log("phoneWxHandler",a),a}return console.log("phoneWxHandler",{}),{}}jsonToArr(u,e){const s={brand:"\u54C1\u724C",category:"\u7C7B\u76EE",average_price:"\u5747\u4EF7"},t=[];return u!=null&&(t.push({span:24,html:""}),Object.keys(u).forEach(a=>{a=="\u70ED\u5356\u7C7B\u76EETOP3"?(t.push({span:6,html:e.label("\u70ED\u5356\u7C7B\u76EE")}),t.push({span:6,html:e.label("\u5747\u4EF7")}),t.push({span:6,html:e.label("\u4F63\u91D1\u53C2\u8003")}),t.push({span:6,html:e.label("\u9500\u552E\u989D")})):a=="\u70ED\u5356\u54C1\u724CTOP3"&&(t.push({span:6,html:e.label("\u70ED\u5356\u54C1\u724C")}),t.push({span:6,html:e.label("\u5747\u4EF7")}),t.push({span:12,html:e.label("\u9500\u552E\u989D")})),a!=null&&u[a].forEach(n=>{Object.keys(n).forEach(c=>{Object.keys(s).forEach(i=>{c==i&&t.push({span:6,html:n[c]})})}),(n.hasOwnProperty("suggest_ratio_min")||n.hasOwnProperty("suggest_ratio_max"))&&t.push({span:6,html:n.suggest_ratio_min+","+n.suggest_ratio_max}),(n.hasOwnProperty("average_GMV_low")||n.hasOwnProperty("average_GMV_high"))&&(n.hasOwnProperty("category")?t.push({span:6,html:n.average_GMV_low+","+n.average_GMV_high}):t.push({span:12,html:n.average_GMV_low+","+n.average_GMV_high}))})})),t}}function Lt(o,u){return u.forGaoqu==J.\u7ED1\u5B9A\u767E\u5E94\u8D44\u6E90?new $t(o,u):u.forGaoqu==J.\u67E5\u8BE2\u767E\u5E94\u5B58\u5728\u8D44\u6E90?new jt(o,u):u.forGaoqu==J.\u68C0\u6D4B\u662F\u5426\u767B\u5F55?new Mt(o,u):new qt(o,u)}class Mt extends X{constructor(u,e){super(u,e),this._init()}async _init(){let u=!1,e=await this._checkEnv(),s="\u767E\u5E94\u73AF\u5883\u68C0\u6D4B\u6B63\u5E38";if(console.log("login",e),e?u=await this.doSomething():s="\u63D2\u4EF6\u672A\u767B\u5F55",console.log("pageLogin",u),e&&u){const{fromTabId:t,tag:a}=this.options;return R(G({tag:a,content:s,pass:u,toTabId:t,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u73AF\u5883\u68C0\u6D4B,closeTab:!0},"\u767E\u5E94\u63D2\u4EF6\u73AF\u5883\u68C0\u6D4B"))}}async doSomething(){var t;let u=!1;const{context:e}=this;let s=await e.$bus.subscribe(/api\/authorStatData\/seekAuthor/,a=>e.$bus.parseBody(a));return console.log("doSomething",s),(t=s.data)!=null&&t.event_track_log_id&&(u=!0),u}}class $t extends X{constructor(u,e){super(u,e),this.doSomething()}doSomething(){const{keyword:u,forGaoqu:e,fromTabId:s,gaoqId:t}=this.options;if(u){let a=setInterval(()=>{let n=document.querySelector(".index__selectorAutoComplete___1Qfjc .auxo-input-group-wrapper .auxo-input");if(console.log("input",n),n){clearInterval(a),n.value=u;var c=new InputEvent("input",{bubbles:!0});n.dispatchEvent(c),document.querySelector(".index__selectorAutoComplete___1Qfjc .auxo-input-group-addon .auxo-input-search-button").click(),setTimeout(()=>{let r=document.querySelector(".auxo-sp-infinit-container");console.log("parent",r),r.addEventListener("click",async function(l){console.log("event",l),l.stopPropagation(),l.preventDefault();let d=l.target;try{for(;d&&!d.classList.contains("daren-card");)d=d.parentNode;if(d){console.log("dom",d);let p=d.getAttribute("data-item-uid"),m=document.createElement("a");m.href="https://buyin.jinritemai.com/dashboard/servicehall/daren-profile?uid="+p+"&fromTabId="+s+"&forGaoqu="+e+"&gaoqId="+t,m.target="_blank",m.click()}}catch(p){console.error(p)}})},2e3)}},500)}}}class jt extends X{constructor(u,e){super(u,e),this.doSomething()}doSomething(){const{keyword:u,fromTabId:e,fromId:s}=this.options,{$bus:t}=this.context;if(u){let a=setInterval(async()=>{let n=document.querySelector(".index__selectorAutoComplete___1Qfjc .auxo-input-group-wrapper .auxo-input");if(console.log("input",n),n){clearInterval(a),await Ie(500),console.log("keyword",u),n.value=u;var c=new InputEvent("input",{bubbles:!0});n.dispatchEvent(c);let i=document.querySelector(".index__selectorAutoComplete___1Qfjc .auxo-input-group-addon .auxo-input-search-button");console.log("search",i);let r="api\\/authorStatData\\/seekAuthor\\?type=2&page=1&refresh=true&req_source=0&query="+encodeURIComponent(u);const l=new RegExp(r);console.log("search",l);const d=t.subscribe(l,function(f){let E=t.parseBody(f);return console.log("body",E),E.data.hasOwnProperty("list")?E.data:!1});i.click();const p=await d;console.log("result",p);let{list:m}=p,h={jump:!1,byCode:""},g=m?m[0]:!1;return g&&g.author_base&&g.author_base.aweme_id==u?h.byCode=g.author_base.uid:h.jump=!0,R(G({data:h,toTabId:e,toId:s,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u63D0\u53D6,closeTab:!0},"\u67E5\u8BE2\u767E\u5E94\u5B58\u5728\u8D44\u6E90"))}},500)}}}class qt extends ye{_updateResourceList(u,e){throw new Error("Method not implemented.")}constructor(u,e){super(u,e)}_otherCss(){return{}}async _collectTag(){const{$bus:u}=this.context,e=await this.busTagsData(u),s=this.dataHandle(e);await this.api.extension.byTag(s)}_updatePage(){}_autoPatchNext(){}async busTagsData(u){const e=await u.subscribe(/\/common\/square\/squareConf/,function(s){let t=u.parseBody(s);return t==null?void 0:t.data});return console.log("busTagData ok ",e),e}dataHandle(u){const{content_types:e,main_cates:s}=u,t=[];e.forEach(n=>{t.push({tag:n})}),s.forEach(n=>{}),console.log("main_cates",s);const a={byMainCategoryTags:s,contentTags:t};return console.log("busTagData ok ",a),a}}class Vt extends me{constructor(u,e){super(u,e)}async _parser(){let{name:u,kind:e,photo:s,fanCount:t,introduce:a,greatCount:n,followCount:c}=this.dom2Data(),i=this.dynamicDom2Data(),{ip:r,sex:l,region:d,mediaId:p,customTags:m}=i,h=i.age,g=window.location.origin+window.location.pathname,E=g.match(/https:\/\/www.douyin.com\/user\/(\S+)/)[1];return e&&(m=[...m,...e.split("\u3001")]),c=K(c),t=K(t),n=K(n),h=h==""?"":K(h),{ip:r,age:h,sex:l,uid:E,name:u,site:g,photo:s,region:d,mediaId:p,version:this.options.version,fanCount:t,introduce:a,greatCount:n,customTags:m,followCount:c,origin:"\u6296\u97F3",platform:"\u6296\u97F3"}}_validateAuto(u){return console.log("form",u),u.uid?!0:(this.context.$Notice.error({title:"\u9047\u5230\u95EE\u9898-_-!",desc:"\u6570\u636E\u4E0D\u5B8C\u5907"}),!1)}_validateSubmit(u){return!0}_formMeta(u){let{options:e,reactive:s}=this;return s.title=`\u8D44\u6E90\u57FA\u672C\u4FE1\u606F(${e.version})`,[this._basicView(u),{align:"middle",gutter:0,subList:[{span:4,html:this.render.label("\u6807\u7B7E")},{span:20,html:u.customTags.join(",")},{span:4,html:this.render.label("\u4ECB\u7ECD")},{span:20,html:u.introduce},{span:4,html:this.render.label("\u6027\u522B")},{span:4,html:u.sex},{span:4,html:this.render.label("\u5E74\u9F84")},{span:4,html:u.age}]}]}_ending(u){const{tag:e,fromTabId:s,forGaoqu:t,fromId:a}=this.options;if(console.log("tag, fromTabId, forGaoqu, fromI",e,s,t,a),s&&s>0&&t==J.\u56DE\u586B\u57FA\u7840\u6570\u636E){let{mediaId:n}=u;return window.navigator.clipboard.writeText(n),R(G({title:"\u6296\u97F3\u53F7\uFF1A"+n+"\u5DF2\u590D\u5236",message:"\u8BF7\u8FD4\u56DEop\u9875\u8FDB\u884C\u7C98\u8D34",msg:$.content\u53D1\u9001\u7ED9background,aim:V.\u7CFB\u7EDF\u901A\u77E5},e)),R(G({data:u,toTabId:s,toId:a,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u63D0\u53D6,closeTab:!0},e))}}dom2Data(){let u=Z('div[data-e2e="user-info"]'),e=u.children[0].innerText,s=e.match(/(.*)\n*(\S*)?/),[t,a,n]=s;e=u.children[1].innerText,s=e.match(/\s*(\S*)\s*\s*(\S*)\s*\s*(\S*)\s*/);let[c,i,r,l]=s,d="";if(u.children[3]){let g=u.children[3].children[0];const f=g.children;if(console.log("length",length),f.length>1){if(f[1].innerText=="\u66F4\u591A"){const b=new MouseEvent("mouseover",{view:window,bubbles:!0,cancelable:!0});g.dispatchEvent(b),d=f[2].innerText}}else d=g.innerText}console.log("introduce",d);let p=Z('div[data-e2e="user-detail"] .avatar-component-avatar-container img');p||(p=u.previousSibling.querySelector("img")),console.error("????",p);let m=p.getAttribute("src");const h={name:a,kind:n,photo:m,fanCount:r,introduce:d,greatCount:l,followCount:i};return console.log("dom2Data ok",h),h}dynamicDom2Data(){let u="",e="",s="",t="",a="";const c=Z('div[data-e2e="user-info"]').children[2];e=c.innerText,u=e.match(/(\S*)\s*(IP\S*)?/);let[i,r,l]=u,d=0;l?l=l.replace("IP\u5C5E\u5730\uFF1A",""):(l="",d=1);const p=[],m=c.children;if(m.length>2-d&&(e=m[2-d].innerText,u=e.match(/(\d*)[]/),u?u[1]==""?s=u[0]:t=u[1]:(u=e.match(/(\S*)(\S*)/),u?a=`${u[1]} ${u[2]}`:p.push(e))),m.length>3-d&&a==""&&(e=m[3-d].innerText,u=e.match(/(\S*)(\S*)/),u?a=`${u[1]} ${u[2]}`:p.push(e)),m.length>4-d&&p.push(m[4-d].innerText),m.length>2-d&&s==""&&t!=""){const g=m[2-d].children[0],f=g?g.getAttribute("xmlns"):"";g&&f=="http://www.w3.org/2000/svg"&&(g.children.length>1?s="\u5973":s="\u7537")}const h={ip:l,sex:s,age:t,region:a,mediaId:r,customTags:p};return console.log("dynamicDom2Data ok",h),h}}class Nt extends X{constructor(u,e){super(u,e),this.doSomething()}doSomething(){this.context.$Notice.success({title:"\u544A\u8DA3\u52A9\u624B",desc:"\u5DF2\u52A0\u8F7D"}),R(G({message:"\u544A\u8DA3\u52A9\u624B\u5DF2\u52A0\u8F7D",msg:$.content\u53D1\u9001\u7ED9background,aim:V.TTS},this.options.tag)),chrome.runtime.onMessage.addListener((u,e,s)=>{console.log(this.options.tag,"onMessage",u),($.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page==u.msg||$.background\u901A\u8FC7content\u53D1\u9001\u7ED9page==u.msg)&&window.postMessage(JSON.stringify(u)),s(this.options.tag+"echo backgorund")}),window.addEventListener("message",async u=>{if(u.data&&u.data[0]==="{")try{let e=JSON.parse(u.data);if($.page\u901A\u8FC7content\u53D1\u9001\u7ED9background==e.msg){console.log("gaoq page\u901A\u8FC7content\u53D1\u9001\u7ED9background",e);let s=await R(e);window.postMessage(JSON.stringify(s))}else $.page\u53D1\u9001\u7ED9content==e.msg&&V.\u83B7\u53D6\u7248\u672C\u4FE1\u606F==e.aim&&window.postMessage(JSON.stringify(G({msg:$.content\u53D1\u9001\u7ED9page,aim:V.\u83B7\u53D6\u7248\u672C\u4FE1\u606F,version:this.options.version},this.options.tag)))}catch(e){console.debug(u.data,e)}})}}class Ht extends X{constructor(u,e){super(u,e),this.doSomething()}doSomething(){let{context:u}=this,{$h:e,$resolveComponent:s}=u;u.renderFunctionMap.popup=function(){let t=s("Button");return[e(t,{type:"success",onClick(){window.location.reload()}},u.publication)]}}}class Rt extends me{constructor(u,e){super(u,e)}_ifEnvOk(){let{$bus:u}=this.context;if(document.querySelector(".login-btn")){const s=/v2\/user\/me/,t=a=>{let n=u.parseBody(a);return console.log(a),n.data};return u.watch(s,t,function(a){a.guest||window.location.reload()}),this.context.$Notice.warning({title:"\u8BF7\u5148\u767B\u5F55\u5C0F\u7EA2\u4E66",desc:"\u672A\u767B\u5F55\u5C0F\u7EA2\u4E66\u8D26\u53F7\uFF0C\u83B7\u53D6\u7C89\u4E1D\u3001\u83B7\u8D5E\u4E0E\u6536\u85CF\u4F1A\u6709\u504F\u5DEE\uFF0C\u7C89\u4E1D\u3001\u83B7\u8D5E\u4E0E\u6536\u85CF\u5C06\u4E0D\u4F1A\u66F4\u65B0",duration:5}),Promise.resolve(!1)}return Promise.resolve(!0)}_parser(){let u=qe.parser();return u.version=this.options.version,Promise.resolve(u)}_formMeta(u){let{brand:e}=u,{options:s,reactive:t}=this;return t.title=`${e?"\u54C1\u724C":"\u8D44\u6E90"}\u57FA\u672C\u4FE1\u606F(${s.version})`,[this._basicView(u),{align:"middle",gutter:0,subList:[{span:4,html:this.render.label("\u4ECB\u7ECD")},{span:20,html:u.introduce},{span:4,html:this.render.label("\u6807\u7B7E")},{span:20,html:u.customTags.join(",")},{span:4,html:this.render.label("\u6027\u522B")},{span:4,html:u.sex},{span:4,html:this.render.label("\u5E74\u9F84")},{span:4,html:u.age}]}]}_beforeSubmit(u){const{brand:e}=u;if(e){const{forGaoqu:s,gaoqId:t}=this.options;s==J.\u7ED1\u5B9A\u5C0F\u7EA2\u4E66\u54C1\u724C&&this.reactive.data.push({desc:"\u7ED1\u5B9A",record:t+""})}}_validateSubmit(u){if(console.log("this.userTabId",this.userTabId,De(this.userTabId.user)),De(this.userTabId.user)){const{fanCount:e,bloggerId:s,brand:t}=u;if(e<5e3&&s!="63fc2548000000002901430b"&&!t)return this.context.$Notice.warning({title:"\u7C89\u4E1D\u91CF\u4F4E",desc:"\u5C0F\u7EA2\u4E66\u7C89\u4E1D\u91CF\u4E0D\u4F4E\u4E8E5000\u624D\u53EF\u5165\u5E93"}),!1}return u.pass=!0,!0}_validateAuto(u){return u.uid?!0:(this.context.$Notice.error({title:"\u9047\u5230\u95EE\u9898-_-!",desc:"\u6570\u636E\u4E0D\u5B8C\u5907"}),!1)}_ending(u){const{tag:e,fromTabId:s,forGaoqu:t,fromId:a}=this.options;if(s&&s>0&&t==J.\u56DE\u586B\u57FA\u7840\u6570\u636E){let{mediaId:n}=u;return window.navigator.clipboard.writeText(n),R(G({title:"\u5C0F\u7EA2\u4E66\u53F7\uFF1A"+n+"\u5DF2\u590D\u5236",message:"\u8BF7\u8FD4\u56DEop\u9875\u8FDB\u884C\u7C98\u8D34",msg:$.content\u53D1\u9001\u7ED9background,aim:V.\u7CFB\u7EDF\u901A\u77E5},e)),R(G({data:u,toTabId:s,toId:a,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u63D0\u53D6,closeTab:!0},e))}}}function Ut(o){const{classes:u}=o.createStyleSheet({"@global":Me,flexContainer:Oe,buttonContainer:Le,gaoqu:be,trigger:ze}).attach();return{classes:u}}class Gt extends X{constructor(e,s){super(e,s);j(this,"classes");j(this,"reactive");this.init()}async init(){this.css(),await this._prepareUser(),this.view(),this.parse(),this.prepareXhsBindBrand()}css(){let{$jss:e}=this.context,{classes:s}=Ut(e);this.classes=s}_afterLogin(){this.prepareXhsBindBrand()}parse(){let e=qe.parser();e.version=this.options.version,this.reactive.form=e}async prepareXhsBindBrand(){if(this.userTabId.user){let{code:e,data:s}=await this.api.brand.fetch({brandId:this.options.gaoqId,opId:this.userTabId.user.id,token:this.userTabId.user.token});e==0&&(this.reactive.brand=s)}}view(){let{context:e,_signOut:s,userTabId:t,classes:a,api:n,options:c}=this,{$h:i,$reactive:r,$resolveComponent:l,$toRaw:d,$Modal:p,$Notice:m}=e,h=r({show:!0,loading:!1,brand:{id:null,name:""},form:{photo:"",uid:"",name:"",mediaId:"",origin:"",platform:"",fanCount:0,greatCount:0,site:"",introduce:"",version:""}});this.reactive=h,e.renderFunctionMap.door=function(){return h.show?null:i("img",{src:e.src,class:a.trigger,onClick(){h.show=!0}})},e.renderFunctionMap.drawer=function(){const g=l("Drawer"),f=l("Icon"),E=l("Collapse"),b=l("Panel"),_=l("Image"),v=l("Button");return i(g,{width:500,mask:!1,modelValue:h.show,"onUpdate:modelValue"(D){h.show=D}},{header(){let D=[i("img",{src:e.src,class:a.gaoqu})];return t.user?(D.push(t.user.name+"("+t.user.id+")"),D.push(i("span",{onClick:s},[i(f,{type:"md-exit",size:13}),"\u767B\u51FA"]))):t.tabId&&D.push(i("a",{href:t.href,target:"_blank"},[i(f,{type:"md-contact",size:13}),"\u767B\u5F55"])),D},default(){return[i(E,{modelValue:["brand","form"]},[i(b,{name:"brand"},{content(){let F=[i("div",{class:"item"},[i("span",{class:"label"},"ID"),i("span",{class:"value"},{default(){return h.brand.id}})]),i("div",{class:"item"},[i("span",{class:"label"},"\u540D\u79F0"),i("span",{class:"value"},{default(){return h.brand.name}})])];return i("div",{class:a.flexContainer},F)},default(){return"OP\u54C1\u724C"}}),i(b,{name:"form"},{content(){let F=[i("div",{class:"item"},[i("span",{class:"label"},"Logo"),h.form.photo?i(_,{src:h.form.photo,fit:"contain",width:"200px"}):""]),i("div",{class:"item"},[i("span",{class:"label"},"UID"),i("span",{class:"value"},{default(){return h.form.uid}})]),i("div",{class:"item"},[i("span",{class:"label"},"\u5A92\u4F53ID"),i("span",{class:"value"},{default(){return h.form.mediaId}})]),i("div",{class:"item"},[i("span",{class:"label"},"\u540D\u79F0"),i("span",{class:"value"},{default(){return h.form.name}})]),i("div",{class:"item"},[i("span",{class:"label"},"\u94FE\u63A5"),i("span",{class:"value"},{default(){return h.form.site}})]),i("div",{class:"item"},[i("span",{class:"label"},"\u5E73\u53F0"),i("span",{class:"value"},{default(){return h.form.platform}})]),i("div",{class:"item"},[i("span",{class:"label"},"\u7C89\u4E1D\u6570"),i("span",{class:"value"},{default(){return h.form.fanCount}})]),i("div",{class:"item"},[i("span",{class:"label"},"\u8D5E\u85CF\u6570"),i("span",{class:"value"},{default(){return h.form.greatCount}})])];return i("div",{class:a.flexContainer},F)},default(){return"\u6293\u53D6\u4FE1\u606F"}})]),i("div",{class:a.buttonContainer},i(v,{disabled:!t.user,long:!0,loading:h.loading,type:"primary",async onClick(){h.loading=!0;let F=d(h.form);F.opId=t.user.id;let C={brandId:h.brand.id,token:t.user.token,extensionImport:F},{code:I,data:M,msg:O}=await n.brand.bind(C);I==0?p.confirm({title:"\u7ED1\u5B9A\u6216\u66F4\u65B0\u6210\u529F",content:"\u8FD4\u56DE\u54C1\u724C\u5185\u9875",onOk(){const{tag:N,fromTabId:S,fromId:k,forGaoqu:y,closeTabIds:U}=c;return R(G({toTabId:S,toId:k,forGaoqu:y,msg:$.content\u901A\u8FC7background\u8F6C\u53D1\u5176\u4ED6content\u53D1\u9001\u7ED9page,aim:V.\u901A\u77E5\u5DF2\u8865\u4E01,closeTab:!0,closeTabIds:U},N))}}):m.error({title:O}),h.loading=!1}},t.user?"\u7ED1\u5B9A":"\u8BF7\u5148\u767B\u5F55\u63D2\u4EF6"))]}})}}}function Jt(o,u){return u.forGaoqu==J.\u7ED1\u5B9A\u5C0F\u7EA2\u4E66\u54C1\u724C?new Gt(o,u):new Rt(o,u)}function de(o,u){return u.find(e=>o.indexOf(e.trim())>-1)}const qe={dynamicDom2Data(){let o=re(".user-info .user-tags"),u="",e="",s=[],t="";if(o){const c="\u5317\u4EAC \u4E0A\u6D77 \u5E7F\u4E1C \u6C5F\u82CF \u6D59\u6C5F \u91CD\u5E86 \u5B89\u5FBD \u798F\u5EFA \u7518\u8083 \u5E7F\u897F \u8D35\u5DDE \u6D77\u5357 \u6CB3\u5317 \u9ED1\u9F99\u6C5F \u6CB3\u5357 \u6E56\u5317 \u6E56\u5357 \u6C5F\u897F \u5409\u6797 \u8FBD\u5B81 \u5185\u8499\u53E4 \u5B81\u590F \u9752\u6D77 \u5C71\u4E1C \u5C71\u897F \u9655\u897F \u56DB\u5DDD \u5929\u6D25 \u65B0\u7586 \u897F\u85CF \u4E91\u5357 \u9999\u6E2F \u6FB3\u95E8 \u53F0\u6E7E \u4E2D\u56FD".split(/\s+/);let i=o.split(`
`);const r=i[0].match(/(\d+)/),l=i[0].match(/()/);r?(u=r[1],i.length==2?de(i[1],c)?e=i[1]:s=[i[1]]:i.length>2&&(de(i[1],c)?(e=i[1],s=i.splice(2,i.length)):s=i.splice(1,i.length))):l?(t=i[0].substr(i[0].length-3,i[0].length),i.length==2?de(i[1],c)?e=i[1]:s=[i[1]]:i.length>2&&(de(i[1],c)?(e=i[1],s=i.splice(2,i.length)):s=i.splice(1,i.length))):de(i[0],c)?(e=i[0],i.length>1&&(s=i.splice(1,i.length))):s=i,t&&s.push(t)}let a=s[0]?s:[];const n={age:u,region:e,customTags:a};return console.log("dynamicDom2Data ok",n),n},dom2Data(){const o=Z(".user-info");let u=re(".user-redId").replace("\u5C0F\u7EA2\u4E66\u53F7\uFF1A",""),e=re(".user-IP").replace("IP\u5C5E\u5730\uFF1A",""),s=re(".user-name").trim(),t=re(".user-info .user-desc");t=="\u8FD8\u6CA1\u6709\u7B80\u4ECB"&&(t="");let a=!1;const n=document.querySelector(".verify-icon .reds-icon use");n&&n.getAttribute("xlink:href").includes("company")&&(a=!0);let c={};const i=document.querySelectorAll(".user-interactions div");for(let h of i){let{innerText:g}=h;g.indexOf("\u5173\u6CE8")>-1?c.followCount=g.replace("\u5173\u6CE8",""):g.indexOf("\u7C89\u4E1D")>-1?c.fanCount=g.replace("\u7C89\u4E1D",""):g.indexOf("\u83B7\u8D5E\u4E0E\u6536\u85CF")>-1&&(c.greatCount=g.replace("\u83B7\u8D5E\u4E0E\u6536\u85CF",""))}const r=Z(".gender svg[class='reds-icon']");let l=Z(".avatar-component-avatar-container img"),d="";r!=null&&(d=r.children[0].attributes["xlink:href"].nodeValue==="#female"?"\u5973":"\u7537"),l||(l=o.querySelector("img"));let p=l.getAttribute("src");const m={brand:a,ip:e,sex:d,name:s,photo:p,mediaId:u,introduce:t,...c};return console.log("dom2Data ok",m),m},parser(){let{fanCount:o,greatCount:u,followCount:e,...s}=this.dom2Data(),t=this.dynamicDom2Data(),{region:a,customTags:n}=t,c=window.location.origin+window.location.pathname,i=window.location.pathname.replace("/user/profile/","");e=K(e),o=K(o),u=K(u);let r=t.age==0?"":K(t.age);const l={...s,age:r,uid:i,site:c,region:a,fanCount:o,greatCount:u,customTags:n,followCount:e,origin:"\u5C0F\u7EA2\u4E66",platform:"\u5C0F\u7EA2\u4E66"};return console.log("data cleaning ok",l),l}};class Wt extends X{constructor(u,e){super(u,e),this.doSomething()}patchForGaoquFromTabId(u,e){let{forGaoqu:s,fromTabId:t,gaoqId:a}=this.options;u&&u.tagName.toLowerCase()=="a"&&(u.href=u.href+`?forGaoqu=${s}&fromTabId=${t}&gaoqId=${a}&closeTabIds=${e}`)}async doSomething(){let u=await R({msg:$.content\u53D1\u9001\u7ED9background,aim:V.\u83B7\u53D6\u5F53\u524DtabId}),{forGaoqu:e,fromTabId:s,gaoqId:t}=this.options;if(J.\u7ED1\u5B9A\u5C0F\u7EA2\u4E66\u54C1\u724C==e&&s&&t){let a=document.querySelectorAll(".content-container .channel");for(let n of a)if(n.innerText.trim()==="\u7528\u6237"){n.click();break}setTimeout(()=>{let n=document.querySelectorAll(".verify-icon");console.log("vList",n);for(let c of n){let i=c.parentNode;for(this.patchForGaoquFromTabId(i,u);i&&!i.classList.contains("user-list-item");)i=i.parentNode,this.patchForGaoquFromTabId(i,u);i&&(i.style="background-color: #19be6b")}},2e3)}}}class Xt extends X{constructor(e,s){s.needInstallCertPem=!0;super(e,s);j(this,"reactive");j(this,"classes");j(this,"checkExists",async(e,s,t=!1)=>{let{user:a}=this.userTabId;if(a){let n={opId:a.id,token:a.token,platform:Q.\u5C0F\u7EA2\u4E66,shop_id:e,product_id:s};if(t){let{shop_name:r,shop_image:l}=this.reactive.shop;n.shop={shop_name:r,shop_image:l}}let{code:c,data:i}=await this.api.goodsImport.checkExists(n);if(c==0){let{memberList:r,...l}=i,d={};r.forEach(p=>{d[p.id]=p}),Object.assign(this.reactive,{...l,memberMap:d}),this.reactive.checked=!0}return i}});j(this,"copyRender",e=>{let{$h:s,$Copy:t}=this.context;return s("span",{class:this.classes.hoverPrimary,onClick(){t({text:e,successTip:"\u5DF2\u590D\u5236:"+e})}},e)});this._init()}async _init(){this._css(),await this._prepareUser(),this._view(),this._parse()}_css(){let{$jss:e}=this.context,{classes:s}=Ce(e);this.classes=s}async _parse(){let{$bus:e,$Notice:s}=this.context,t=window.location.href.match(/\/goods-detail\/([^?]*)/);if(t){let a=decodeURIComponent(t[1]),{template_data:n}=await e.subscribe(/jpd\/main/,p=>e.parseBody(p).data),{sellerH5:c,descriptionMain:i,carouselH5:r,priceH5:l,graphicDetailsV4:d}=n[0];this.fillProduct(i,r,l,d),this.fillShop(c),this.checkExists(this.reactive.shop.shop_id,a,!0)}else s.error({title:"\u9047\u5230\u95EE\u9898-_-!",desc:"\u672A\u80FD\u89E3\u6790\u5546\u54C1id"})}fillProduct(e,s,t,a){let{name:n,itemId:c}=e,{images:i}=s,{href:r}=window.location,{highlightPrice:l}=t;i=i.map(d=>d.url),Object.assign(this.reactive.goods,{aim_commission_rate:null,commission_rate:"",price:l*100,title:n,product_id:c,cover:i[0],images:i,details:a.images.map(d=>d.url),detail_url:r,from_url:r,urgent:0})}fillShop(e){let{id:s,name:t,logo:a,salesVolume:n,sellerScore:c,fansAmount:i,grade:r}=e;Object.assign(this.reactive.shop,{shop_id:s,shop_name:t,shop_image:a,saleQuantity:Be(n.replace("\u5DF2\u552E","").trim()),fansNum:Be(i.replace("\u7C89\u4E1D\u6570","").trim())})}_afterLogin(){let{checked:e,shop:s,goods:t}=this.reactive;if(!e){let{shop_id:a}=s,{product_id:n}=t;a&&n&&this.checkExists(a,n,!0)}}_view(){let{context:e,_signOut:s,userTabId:t,classes:a,api:n,checkExists:c,copyRender:i}=this,{$h:r,$reactive:l,$resolveComponent:d,$toRaw:p,$Message:m,$Notice:h,$Copy:g}=e,f=l({show:!0,loading:!1,checked:!1,exists:!1,shopList:[],goodsImportList:[],memberMap:{},updatedTime:"",shop:{shop_id:"",shop_name:"",shop_image:"",platform:Q.\u5C0F\u7EA2\u4E66,importOrigin:se.\u63D2\u4EF6,platformOrigin:ae.\u5C0F\u7EA2\u4E66},goods:{aim_commission_rate:null,commission_rate:"",price:null,title:"",product_id:"",cover:"",images:[],details:[],detail_url:"",from_url:"",urgent:0,platform:Q.\u5C0F\u7EA2\u4E66,importOrigin:se.\u63D2\u4EF6,platformOrigin:ae.\u5C0F\u7EA2\u4E66}});this.reactive=f,e.renderFunctionMap.door=function(){return f.show?null:r("img",{src:e.src,class:a.trigger,onClick(){f.show=!0}})},e.renderFunctionMap.drawer=function(){const E=d("Drawer"),b=d("Icon"),_=d("Collapse"),v=d("Panel"),D=d("Image"),F=d("Button"),C=d("Spin"),I=d("Table"),M=d("InputNumber"),O=d("Checkbox"),N=d("Result"),S=d("Numeral");let{shop:k,goods:y,checked:U,shopList:x,goodsImportList:T,memberMap:H}=f,L=x.length;return r(E,{width:500,mask:!1,modelValue:f.show,"onUpdate:modelValue"(A){f.show=A}},{header(){let A=[r("img",{src:e.src,class:a.gaoqu})];return t.user?(A.push(t.user.name+"("+t.user.id+")"),A.push(r("span",{onClick:s},[r(b,{type:"md-exit",size:13}),"\u767B\u51FA"]))):t.tabId&&A.push(r("a",{href:t.href,target:"_blank"},[r(b,{type:"md-contact",size:13}),"\u767B\u5F55"])),A},default(){if(t.user){let A=[r(_,{modelValue:["goodsImport","shop"]},[r(v,{name:"goodsImport"},{content(){let P=[r("div",{class:"item"},[r("span",{class:"label"},"\u4EF7\u683C"),r("span",{class:"value"},{default(){return y.price/100+"\uFFE5"}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u8C08\u5224\u4F63\u91D1\u7387*"),r("span",{class:"value"},[r(M,{max:100,min:0,size:"small",modelValue:y.aim_commission_rate,"onUpdate:modelValue":w=>{y.aim_commission_rate=+w}}),"%",y.aim_commission_rate?"":r("span",{class:a.error},"\u8C08\u5224\u4F63\u91D1\u7387\u5FC5\u586B")])]),r("div",{class:"item"},[r("span",{class:"label"},"\u662F\u5426\u52A0\u6025"),r(O,{trueValue:1,falseValue:0,class:"value",size:"small",modelValue:y.urgent,"onUpdate:modelValue":w=>{y.urgent=w}},"\u52A0\u6025")]),r("div",{class:"item"},[r("span",{class:"label"},"ID"),i(y.product_id)]),r("div",{class:"item"},[r("span",{class:"label"},"\u540D\u79F0"),r("span",{class:"value"},{default(){return y.title}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u5C01\u9762"),y.cover?r(D,{src:y.cover,fit:"contain",preview:!0,previewList:y.details,class:a.img}):""]),r("div",{class:"item"},[r("span",{class:"label"},"\u94FE\u63A5"),r("span",{class:"value"},{default(){return y.detail_url}})]),r("div",{class:"item"},[r("span",{class:"label"},"\u6765\u6E90"),r("span",{class:"value"},{default(){return y.from_url}})])];return T.length>0&&P.unshift(r(I,{data:T,size:"small",columns:[{type:"index",width:30},{title:"\u5546\u54C1",className:a.clearPadding,minWidth:130,render(w,{row:B}){return[i(B.product_id),"/",B.title]}},{title:"\u8C08\u5224\u4F63\u91D1\u7387",width:70,align:"center",fixed:"right",render(w,{row:B}){return[(B.commission_rate||0)+"%","/",w("span",{class:a.success},B.aim_commission_rate+"%")]}},{title:"\u8C08\u5224\u72B6\u6001",width:70,className:a.clearPadding,align:"center",render(w,{row:B}){return we(B.status)}},{title:"\u8C08\u5224\u4EBA\u5458",width:80,className:a.clearPadding,align:"center",render(w,{row:B}){let q=H[B.zsOpId];return q?w("div",{class:a.photoFlex},[w("img",{src:ee(q.photo),class:"photo"}),q.name]):""}},{title:"\u5165\u5E93\u65F6\u95F4",width:120,className:a.clearPadding,align:"center",render(w,{row:B}){return oe(new Date(B.createdAt))}}]})),r("div",{class:a.flexContainer},P)},default(){return["\u8C08\u5224\u5546\u54C1",r("span",{class:T.length>0?a.info:a.success},T.length>0?`\u5DF2\u5B58\u5728${T.length}\u4E2A\u76F8\u540C\u8C08\u5224\u5546\u54C1`:"")]}}),r(v,{name:"shop"},{content(){let P=[r("div",{class:"item"},[r("span",{class:"label"},"ID"),i(k.shop_id)]),r("div",{class:"item"},[r("span",{class:"label"},"\u540D\u79F0"),r("span",{class:"value"},{default(){return k.shop_name}})]),r("div",{class:"item"},[r("span",{class:"label"},"Logo"),k.shop_image?r(D,{src:k.shop_image,fit:"contain",preview:!0,class:a.img}):""]),r("div",{class:"item"},[r("span",{class:"label"},"\u7C89\u4E1D\u6570"),r(S,{value:k.fansNum,format:"0,0"})]),r("div",{class:"item"},[r("span",{class:"label"},"\u5DF2\u552E"),r(S,{value:k.saleQuantity,format:"0,0"})])];return U&&L>0&&P.unshift(r(I,{data:x,size:"small",columns:[{type:"index",width:30},{title:"\u5E97\u94FA",className:a.clearPadding,minWidth:130,render(w,{row:B}){return[i(B.shop_id),"/",B.shop_name]}},{title:"\u8D23\u4EFB\u5546\u52A1",width:100,className:a.clearPadding,align:"center",render(w,{row:B}){let q=H[B.zsOpId];return q?r("div",{class:a.photoFlex},[r("img",{src:ee(q.photo),class:"photo"}),q.name]):""}},{title:"\u5165\u5E93\u65F6\u95F4",width:120,className:a.clearPadding,align:"center",render(w,{row:B}){return oe(new Date(B.createdAt))}}]})),r("div",{class:a.flexContainer},P)},default(){return["\u5E97\u94FA",r("span",{class:L>0?a.info:a.success},L>0?`\u5DF2\u5B58\u5728${L}\u4E2A\u76F8\u540C\u5E97\u94FA`:"\u53EF\u5165\u5E93")]}})]),r("div",{class:a.buttonContainer},r(F,{disabled:!U,long:!0,loading:f.loading,type:"primary",async onClick(){if(y.aim_commission_rate)if(y.commission_rate&&y.aim_commission_rate<parseInt(y.commission_rate))h.error({desc:"\u8C08\u5224\u4F63\u91D1\u7387\u4E0D\u80FD\u4F4E\u4E8E"+y.commission_rate+"%"});else{f.loading=!0;let P={opId:t.user.id,token:t.user.token,shop:p(f.shop),goods:p(y)},{code:w,data:B}=await n.goodsImport.import(P);w==0&&(B>0?h.error({title:"\u65E0\u9700\u521B\u5EFA\u8C08\u5224\u5546\u54C1",desc:"\u5DF2\u5B58\u5728\u76F8\u540C\u7684\u4F63\u91D1\u7387"}):m.success("\u6210\u529F\u521B\u5EFA\u5546\u54C1\u8C08\u5224")),f.loading=!1,c(k.shop_id,y.product_id)}else h.error({desc:"\u8BF7\u5148\u586B\u5199\u8C08\u5224\u4F63\u91D1\u7387"})}},(L<1?"\u5165\u5E93":"\u66F4\u65B0")+"\u5E97\u94FA\u5E76\u521B\u5EFA\u5546\u54C1\u8C08\u5224"+(y.aim_commission_rate?y.aim_commission_rate+"%":"")))];return U||A.push(r(C,{fix:!0})),A}else return r(N,{type:"warning",title:"\u8BF7\u5148\u767B\u5F55",class:a.marginTop},{actions(){return r(F,{type:"success",onClick(){window.open(t.href,"_blank")}},"\u9A6C\u4E0A\u767B\u5F55")}})}})}}}class Kt{constructor(u,e){j(this,"options");j(this,"context");this.context=u,this.options=e,this.init()}get api(){return Te(this.context.$ajax)}init(){let{$bus:u,$Message:e}=this.context;const s=/solar\/user\/info/,t=n=>u.parseBody(n).data,a={nickName:"",userId:"",cookie:"",platform:"\u84B2\u516C\u82F1"};u.watch(s,t,n=>{a.nickName=n.nickName,a.userId=n.userId,a.nickName&&a.userId&&R(G({msg:$.content\u53D1\u9001\u7ED9background,aim:V.Cookie,domain:".xiaohongshu.com"},this.options.tag))}),chrome.runtime.onMessage.addListener(async(n,c,i)=>{if($.content\u53D1\u9001\u7ED9background==n.msg&&V.Cookie==n.aim)if(a.cookie=n.cookies.map(r=>`${r.name}=${r.value}`).join(";"),a.cookie.indexOf("solar.beaker.session.id")>-1){let r=await chrome.storage.local.get("user");r&&r.user&&(a.opId=r.user.id);let{code:l,data:d}=await this.api.platformAccount.record(a);l==0&&e.success({content:"\u5DF2\u540C\u6B65\u8D26\u53F7\u6570\u636E"+a.nickName})}else console.error("cookie\u4E2D\u4E0D\u5305\u542Bsolar.beaker.session.id",a);i(this.options.tag+"echo backgorund")})}}console.log("12345abcde");function Yt(o){let u=["api/solar/user/info","api/contact/contact_info","api/author/get_author_base_info","api/author/get_author_marketing_info","api/author/get_author_platform_channel_info_v2","api/authorStatData/authorProfile","homePage/author/profile","api/solar/cooperator/user/blogger","api/authorStatData/salesAnalyseV2","solar/cooperator/blogger/v2","api/solar/cooperator/content/tag_tree","api/solar/kol/get_select_kol_tags_config_v2","api/user/author_options","api/data_sp/author_video_distribution","api/data_sp/get_author_spread_info","api/data_sp/author_link_struct","api/solar/kol/dataV3/dataSummary","api/data_sp/author_touch_distribution","draco/distributor-square/distributor/cooperative","api/solar/kol/dataV2/notesDetail","api/solar/kol/dataV3/notesRate","api/data_sp/author_audience_distribution","api/draco/selection-center/seller/detail/basic","api/draco/selection-center/seller/detail/data","api/draco/selection-center/seller/detail/cooperation/intention","api/draco/selection-center/item/detail/basic","api/draco/selection-center/item/detail/data","api/draco/selection-center/item/detail/images","api/store/jpd/main","api/authorStatData/authorOverviewV2","authorStatData/authorFansV2","authorStatData/sellProduct","api/data_sp/get_author_link_info","square_pc_api/common/square/squareConf","getOtherData","api/authorStatData/seekAuthor","gsearch/search_for_author_square","publishMediaIdAnduid","api/gauthor/author_get_business_card_info","captain_goods_pool/get_captain_goods_detail","shop/promotion/pack/h5/","v2/user/me","www.douyin.com/user/","api/demander/grade_info","api/solar/user/info"];chrome.storage.local.set({whiteList:u},function(){console.log("chrome.storage.local.set whiteList callback",u.length,chrome.runtime.lastError)}),console.log("chrome.storage.local.set done",o,u.length);let{href:e}=window.location;(e.indexOf("buyin.jinritemai")>-1||e.indexOf("www.douyin.com")>-1)&&R({title:"\u544A\u8DA3",message:"\u7F13\u5B58\u6587\u4EF6\u5DF2\u6E05\u7406",msg:$.content\u53D1\u9001\u7ED9background,aim:V.\u6E05\u7406\u7F13\u5B58,options:{origins:["https://lf-c-flwb.bytetos.com","https://lf-headquarters-speed.yhgfb-cn-static.com"]},dataSet:{cache:!0,cacheStorage:!0,fileSystems:!0}});let t={version:o,tag:W.Empty},a=e.match(/[&?]grab=(\d*)/);t.grab=a?+a[1]:pe.\u5C3D\u91CF\u6293\u53D6\u989D\u5916\u6570\u636E,a=e.match(/[&?]fromTabId=(\d*)/),t.fromTabId=a?+a[1]:0,a=e.match(/[?&]gaoqId=(\d*)/),t.gaoqId=a?+a[1]:0,a=e.match(/[?&%26]forGaoqu=(\d*)/),t.forGaoqu=a?+a[1]:0,a=e.match(/[?&]forDebug=(\d*)/),t.forDebug=a?+a[1]:0,a=e.match(/[?&]fromId=([a-z\d]*)/),t.fromId=a?a[1]:0,a=e.match(/[?&]closeTabIds=([\d,]*)/),t.closeTabIds=a?a[1].split(",").map(c=>parseInt(c)):[],a=window.location.search.match(/\?keyword=([^&]*)/),t.keyword=a?decodeURIComponent(a[1]):0,a=window.location.search.match(/[&?]name=([^&]*)/),t.name=a?decodeURIComponent(a[1]):0;let n=window._context;if(console.log("context",n,t,e),/chrome-extension:\/\/.*\/popup\.html/.test(e))return t.tag=W.Popup,new Ht(n,t);if(/http:\/\/op\.gaoq\.com\//.test(e)||/http:\/\/localhost:8088\//.test(e))return t.tag=W.OP,new Nt(n,t);if(/https:\/\/www\.douyin\.com\/user\//.test(e))return t.tag=W.Dy,new Vt(n,t);if(/https:\/\/www\.xiaohongshu\.com\/search_result/.test(e))return t.tag=W.XhsSearch,new Wt(n,t);if(/https:\/\/www\.xiaohongshu\.com\/goods-detail/.test(e))return t.tag=W.XhsProduct,new Xt(n,t);if(/https:\/\/www\.xiaohongshu\.com\/user\/profile/.test(e))return t.tag=W.Xhs,Jt(n,t);if(/https:\/\/pgy\.xiaohongshu\.com/.test(e)){if(new Kt(n,t),/solar\/pre-trade\/blogger-detail\//.test(e))return t.tag=W.Pgy,new _t(n,t);if(/solar\/pre-trade\/note\/kol/.test(e))return t.tag=W.PgySearch,gt(n,t);if(/microapp\/selection\/product-detail/.test(e))return t.tag=W.PgyProduct,new It(n,t)}else{if(/https:\/\/www\.xingtu\.cn\/ad\/creator\/author\/douyin/.test(e))return t.tag=W.Xt,new kt(n,t);if(/https:\/\/buyin\.jinritemai\.com\/dashboard\/servicehall\/daren-profile/.test(e))return t.tag=W.ByResource,new Ot(n,t);if(/https:\/\/buyin\.jinritemai\.com\/dashboard\/servicehall\/daren-square/.test(e))return t.tag=W.BySearch,Lt(n,t);if(/https:\/\/haohuo\.jinritemai\.com\/ecommerce\/trade\/detail/.test(e))return t.tag=W.ByProductHaohuo,ct(n,t);if(/https:\/\/buyin\.jinritemai\.com\/dashboard\/goodsCooperation/.test(e)){debugger;return t.tag=W.ByProduct,new lt(n,t)}else if(/https:\/\/www\.xingtu\.cn\/ad\/creator\/market/.test(e))return t.tag=W.XtSearch,Pt(n,t)}}export{Yt as default};
